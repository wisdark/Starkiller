import{m as f,C as w,o as P,aB as qe,c as p,T as z,b as v,ag as We,aC as He,aD as te,aE as X,aF as ge,g as Ke,w as L,aq as ve,a1 as _,aG as he,K as Ge,t as Q,aH as Ze,a2 as x,af as H,aI as Je,aJ as Xe,h as Qe,P as et,aK as tt,aL as it,am as st,v as h,al as nt,ak as at,aM as rt,a6 as lt,n as k,a as I,i as ot,aN as ht,aO as dt,aP as ut,aQ as de,ad as R,aR as M,aS as _e,ab as b,aT as ct,j as ye,k as D,V as A,aU as ie,aV as se,aW as j,aX as ne,aY as K,aZ as be,a_ as pt,a0 as mt,a$ as ft,b0 as gt,b1 as ae,ay as vt,b2 as _t,b3 as yt,l as bt}from"./index.81c4d563.js";import{h as N}from"./moment.9709ab41.js";import{_ as O,a as T}from"./VRow.2b8953c0.js";import{a as ke}from"./GeneralForm.3e2538c0.js";import{b as $e,_ as re}from"./VSelect.0bed7eeb.js";import{_ as S}from"./TooltipButton.21f18540.js";import{l as we,_ as kt}from"./index.e2615468.js";import{D as $t}from"./download-stager.85a6b476.js";import{a as wt,b as xt,c as St,d as Ct}from"./download-api.ea02701a.js";import{_ as Tt,a as Dt,b as Pt,c as zt}from"./VExpansionPanelHeader.b3e1c802.js";import{_ as It}from"./VDataTable.854575c5.js";import{_ as U}from"./VTooltip.97c87792.js";import{_ as q}from"./AgentExecuteModule.79b00c00.js";import{a as xe,_ as Se}from"./ErrorStateAlert.1e369898.js";import{B as F}from"./VItemGroup.1df2c7e0.js";import{_ as At,a as B,b as Mt,c as E}from"./VTabItem.77fcbebb.js";import{_ as Ft}from"./VBreadcrumbs.8405c320.js";import"./VSwitch.35d52e8f.js";import"./index.1e892548.js";import"./TechniqueChips.96fa6b5e.js";import"./InfoViewer.faacbbba.js";import"./index.724a936b.js";const G=F.extend({name:"button-group",provide(){return{btnToggle:this}},computed:{classes(){return F.options.computed.classes.call(this)}},methods:{genData:F.options.methods.genData}});const Ot=f(G,w).extend({name:"v-btn-toggle",props:{backgroundColor:String,borderless:Boolean,dense:Boolean,group:Boolean,rounded:Boolean,shaped:Boolean,tile:Boolean},computed:{classes(){return{...G.options.computed.classes.call(this),"v-btn-toggle":!0,"v-btn-toggle--borderless":this.borderless,"v-btn-toggle--dense":this.dense,"v-btn-toggle--group":this.group,"v-btn-toggle--rounded":this.rounded,"v-btn-toggle--shaped":this.shaped,"v-btn-toggle--tile":this.tile,...this.themeClasses}}},methods:{genData(){const t=this.setTextColor(this.color,{...G.options.methods.genData.call(this)});return this.group?t:this.setBackgroundColor(this.backgroundColor,t)}}}),W=P.extend({name:"localable",props:{locale:String},computed:{currentLocale(){return this.locale||this.$vuetify.lang.current}}});function Bt(t,e=0,i=1){let s;return t<100&&t>=0?(s=new Date(Date.UTC(t,e,i)),isFinite(s.getUTCFullYear())&&s.setUTCFullYear(t)):s=new Date(Date.UTC(t,e,i)),s}function ee(t,e,i){const s=7+e-i;return-((7+Bt(t,0,s).getUTCDay()-e)%7)+s-1}function Et(t,e,i,s){let n=[0,31,59,90,120,151,181,212,243,273,304,334][e];return e>1&&le(t)&&n++,n+i}function Z(t,e,i){const s=ee(t,e,i),n=ee(t+1,e,i);return((le(t)?366:365)-s+n)/7}function Vt(t,e,i,s,n){const a=ee(t,s,n),r=Math.ceil((Et(t,e,i)-a)/7);return r<1?r+Z(t-1,s,n):r>Z(t,s,n)?r-Z(t,s,n):r}function le(t){return t%4===0&&t%100!==0||t%400===0}const Lt=[0,31,28,31,30,31,30,31,31,30,31,30,31],Nt=[0,31,29,31,30,31,30,31,31,30,31,30,31];function Yt(t,e){return le(t)?Nt[e]:Lt[e]}const Rt=f(w).extend({methods:{genPickerButton(t,e,i,s=!1,n=""){const a=this[t]===e,r=l=>{l.stopPropagation(),this.$emit(`update:${qe(t)}`,e)};return this.$createElement("div",{staticClass:`v-picker__title__btn ${n}`.trim(),class:{"v-picker__title__btn--active":a,"v-picker__title__btn--readonly":s},on:a||s?void 0:{click:r}},Array.isArray(i)?i:[i])}}}),jt=f(Rt).extend({name:"v-date-picker-title",props:{date:{type:String,default:""},disabled:Boolean,readonly:Boolean,selectingYear:Boolean,value:{type:String},year:{type:[Number,String],default:""},yearIcon:{type:String}},data:()=>({isReversing:!1}),computed:{computedTransition(){return this.isReversing?"picker-reverse-transition":"picker-transition"}},watch:{value(t,e){this.isReversing=t<e}},methods:{genYearIcon(){return this.$createElement(p,{props:{dark:!0}},this.yearIcon)},getYearBtn(){return this.genPickerButton("selectingYear",!0,[String(this.year),this.yearIcon?this.genYearIcon():null],!1,"v-date-picker-title__year")},genTitleText(){return this.$createElement("transition",{props:{name:this.computedTransition}},[this.$createElement("div",{domProps:{innerHTML:this.date||"&nbsp;"},key:this.value})])},genTitleDate(){return this.genPickerButton("selectingYear",!1,[this.genTitleText()],!1,"v-date-picker-title__date")}},render(t){return t("div",{staticClass:"v-date-picker-title",class:{"v-date-picker-title--disabled":this.disabled}},[this.getYearBtn(),this.genTitleDate()])}});function Ce(t,e,i){return Object.keys(t.$listeners).reduce((s,n)=>(n.endsWith(e)&&(s[n.slice(0,-e.length)]=a=>t.$emit(n,i,a)),s),{})}function J(t,e){return Object.keys(t.$listeners).reduce((i,s)=>(s.endsWith(e)&&(i[s]=t.$listeners[s]),i),{})}const Ut=(t,e,i)=>(e=e>>0,t=String(t),i=String(i),t.length>e?String(t):(e=e-t.length,e>i.length&&(i+=i.repeat(e/i.length)),i.slice(0,e)+String(t))),d=(t,e=2)=>Ut(t,e,"0");function C(t,e,i={start:0,length:0}){const s=n=>{const[a,r,l]=n.trim().split(" ")[0].split("-");return[d(a,4),d(r||1),d(l||1)].join("-")};try{const n=new Intl.DateTimeFormat(t||void 0,e);return a=>n.format(new Date(`${s(a)}T00:00:00+00:00`))}catch{return i.start||i.length?a=>s(a).substr(i.start||0,i.length):void 0}}const Te=(t,e)=>{const[i,s]=t.split("-").map(Number);return s+e===0?`${i-1}-12`:s+e===13?`${i+1}-01`:`${i}-${d(s+e)}`},m=(t,e)=>{const[i,s=1,n=1]=t.split("-");return`${i}-${d(s)}-${d(n)}`.substr(0,{date:10,month:7,year:4}[e])},qt=f(w,W,z).extend({name:"v-date-picker-header",props:{disabled:Boolean,format:Function,min:String,max:String,nextAriaLabel:String,nextIcon:{type:String,default:"$next"},prevAriaLabel:String,prevIcon:{type:String,default:"$prev"},readonly:Boolean,value:{type:[Number,String],required:!0}},data(){return{isReversing:!1}},computed:{formatter(){return this.format?this.format:String(this.value).split("-")[1]?C(this.currentLocale,{month:"long",year:"numeric",timeZone:"UTC"},{length:7}):C(this.currentLocale,{year:"numeric",timeZone:"UTC"},{length:4})}},watch:{value(t,e){this.isReversing=t<e}},methods:{genBtn(t){const e=t>0?this.nextAriaLabel:this.prevAriaLabel,i=e?this.$vuetify.lang.t(e):void 0,s=this.disabled||t<0&&this.min&&this.calculateChange(t)<this.min||t>0&&this.max&&this.calculateChange(t)>this.max;return this.$createElement(v,{attrs:{"aria-label":i},props:{dark:this.dark,disabled:s,icon:!0,light:this.light},on:{click:n=>{n.stopPropagation(),this.$emit("input",this.calculateChange(t))}}},[this.$createElement(p,t<0==!this.$vuetify.rtl?this.prevIcon:this.nextIcon)])},calculateChange(t){const[e,i]=String(this.value).split("-").map(Number);return i==null?`${e+t}`:Te(String(this.value),t)},genHeader(){const t=!this.disabled&&(this.color||"accent"),e=this.$createElement("div",this.setTextColor(t,{key:String(this.value)}),[this.$createElement("button",{attrs:{type:"button"},on:{click:()=>this.$emit("toggle")}},[this.$slots.default||this.formatter(String(this.value))])]),i=this.$createElement("transition",{props:{name:this.isReversing===!this.$vuetify.rtl?"tab-reverse-transition":"tab-transition"}},[e]);return this.$createElement("div",{staticClass:"v-date-picker-header__value",class:{"v-date-picker-header__value--disabled":this.disabled}},[i])}},render(){return this.$createElement("div",{staticClass:"v-date-picker-header",class:{"v-date-picker-header--disabled":this.disabled,...this.themeClasses}},[this.genBtn(-1),this.genHeader(),this.genBtn(1)])}});function De(t,e,i,s){return(!s||s(t))&&(!e||t>=e.substr(0,10))&&(!i||t<=i)}const Pe=f(w,W,z).extend({directives:{Touch:We},props:{allowedDates:Function,current:String,disabled:Boolean,format:Function,events:{type:[Array,Function,Object],default:()=>null},eventColor:{type:[Array,Function,Object,String],default:()=>"warning"},min:String,max:String,range:Boolean,readonly:Boolean,scrollable:Boolean,tableDate:{type:String,required:!0},value:[String,Array]},data:()=>({isReversing:!1,wheelThrottle:null}),computed:{computedTransition(){return this.isReversing===!this.$vuetify.rtl?"tab-reverse-transition":"tab-transition"},displayedMonth(){return Number(this.tableDate.split("-")[1])-1},displayedYear(){return Number(this.tableDate.split("-")[0])}},watch:{tableDate(t,e){this.isReversing=t<e}},mounted(){this.wheelThrottle=He(this.wheel,250)},methods:{genButtonClasses(t,e,i,s,n,a){return{"v-size--default":!e,"v-date-picker-table__current":s,"v-btn--active":i,"v-btn--flat":!t||this.disabled,"v-btn--text":i===s,"v-btn--rounded":e,"v-btn--disabled":!t||this.disabled,"v-btn--outlined":s&&!i,"v-date-picker--first-in-range":n,"v-date-picker--last-in-range":a,...this.themeClasses}},genButtonEvents(t,e,i){if(!this.disabled)return te({click:()=>{e&&!this.readonly&&this.$emit("input",t)}},Ce(this,`:${i}`,t))},genButton(t,e,i,s,n=!1){const a=De(t,this.min,this.max,this.allowedDates),r=this.isSelected(t)&&a,l=t===this.current,o=r?this.setBackgroundColor:this.setTextColor,u=(r||l)&&(this.color||"accent");let y=!1,g=!1;return this.range&&!!this.value&&Array.isArray(this.value)&&(y=t===this.value[0],g=t===this.value[this.value.length-1]),this.$createElement("button",o(u,{staticClass:"v-btn",class:this.genButtonClasses(a&&!n,e,r,l,y,g),attrs:{type:"button"},domProps:{disabled:this.disabled||!a||n},on:this.genButtonEvents(t,a,i)}),[this.$createElement("div",{staticClass:"v-btn__content"},[s(t)]),this.genEvents(t)])},getEventColors(t){const e=n=>Array.isArray(n)?n:[n];let i,s=[];if(Array.isArray(this.events)?i=this.events.includes(t):this.events instanceof Function?i=this.events(t)||!1:this.events?i=this.events[t]||!1:i=!1,i)i!==!0?s=e(i):typeof this.eventColor=="string"?s=[this.eventColor]:typeof this.eventColor=="function"?s=e(this.eventColor(t)):Array.isArray(this.eventColor)?s=this.eventColor:s=e(this.eventColor[t]);else return[];return s.filter(n=>n)},genEvents(t){const e=this.getEventColors(t);return e.length?this.$createElement("div",{staticClass:"v-date-picker-table__events"},e.map(i=>this.$createElement("div",this.setBackgroundColor(i)))):null},isValidScroll(t,e){const i=e(t),s=i.split("-").length===1?"year":"month";return t<0&&(this.min?i>=m(this.min,s):!0)||t>0&&(this.max?i<=m(this.max,s):!0)},wheel(t,e){this.$emit("update:table-date",e(t.deltaY))},touch(t,e){this.$emit("update:table-date",e(t))},genTable(t,e,i){const s=this.$createElement("transition",{props:{name:this.computedTransition}},[this.$createElement("table",{key:this.tableDate},e)]),n={name:"touch",value:{left:a=>a.offsetX<-15&&this.isValidScroll(1,i)&&this.touch(1,i),right:a=>a.offsetX>15&&this.isValidScroll(-1,i)&&this.touch(-1,i)}};return this.$createElement("div",{staticClass:t,class:{"v-date-picker-table--disabled":this.disabled,...this.themeClasses},on:!this.disabled&&this.scrollable?{wheel:a=>{a.preventDefault(),this.isValidScroll(a.deltaY,i)&&this.wheelThrottle(a,i)}}:void 0,directives:[n]},[s])},isSelected(t){if(Array.isArray(this.value))if(this.range&&this.value.length===2){const[e,i]=[...this.value].sort();return e<=t&&t<=i}else return this.value.indexOf(t)!==-1;return t===this.value}}}),Wt=f(Pe).extend({name:"v-date-picker-date-table",props:{firstDayOfWeek:{type:[String,Number],default:0},localeFirstDayOfYear:{type:[String,Number],default:0},showAdjacentMonths:Boolean,showWeek:Boolean,weekdayFormat:Function},computed:{formatter(){return this.format||C(this.currentLocale,{day:"numeric",timeZone:"UTC"},{start:8,length:2})},weekdayFormatter(){return this.weekdayFormat||C(this.currentLocale,{weekday:"narrow",timeZone:"UTC"})},weekDays(){const t=parseInt(this.firstDayOfWeek,10);return this.weekdayFormatter?X(7).map(e=>this.weekdayFormatter(`2017-01-${t+e+15}`)):X(7).map(e=>["S","M","T","W","T","F","S"][(e+t)%7])}},methods:{calculateTableDate(t){return Te(this.tableDate,Math.sign(t||1))},genTHead(){const t=this.weekDays.map(e=>this.$createElement("th",e));return this.showWeek&&t.unshift(this.$createElement("th")),this.$createElement("thead",this.genTR(t))},weekDaysBeforeFirstDayOfTheMonth(){return(new Date(`${this.displayedYear}-${d(this.displayedMonth+1)}-01T00:00:00+00:00`).getUTCDay()-parseInt(this.firstDayOfWeek)+7)%7},getWeekNumber(t){return Vt(this.displayedYear,this.displayedMonth,t,parseInt(this.firstDayOfWeek),parseInt(this.localeFirstDayOfYear))},genWeekNumber(t){return this.$createElement("td",[this.$createElement("small",{staticClass:"v-date-picker-table--date__week"},String(t).padStart(2,"0"))])},genTBody(){const t=[],e=new Date(this.displayedYear,this.displayedMonth+1,0).getDate();let i=[],s=this.weekDaysBeforeFirstDayOfTheMonth();this.showWeek&&i.push(this.genWeekNumber(this.getWeekNumber(1)));const n=this.displayedMonth?this.displayedYear:this.displayedYear-1,a=(this.displayedMonth+11)%12,r=new Date(this.displayedYear,this.displayedMonth,0).getDate(),l=this.showWeek?8:7;for(;s--;){const g=`${n}-${d(a+1)}-${d(r-s)}`;i.push(this.$createElement("td",this.showAdjacentMonths?[this.genButton(g,!0,"date",this.formatter,!0)]:[]))}for(s=1;s<=e;s++){const g=`${this.displayedYear}-${d(this.displayedMonth+1)}-${d(s)}`;i.push(this.$createElement("td",[this.genButton(g,!0,"date",this.formatter)])),i.length%l===0&&(t.push(this.genTR(i)),i=[],this.showWeek&&(s<e||this.showAdjacentMonths)&&i.push(this.genWeekNumber(this.getWeekNumber(s+7))))}const o=this.displayedMonth===11?this.displayedYear+1:this.displayedYear,u=(this.displayedMonth+1)%12;let y=1;for(;i.length<l;){const g=`${o}-${d(u+1)}-${d(y++)}`;i.push(this.$createElement("td",this.showAdjacentMonths?[this.genButton(g,!0,"date",this.formatter,!0)]:[]))}return i.length&&t.push(this.genTR(i)),this.$createElement("tbody",t)},genTR(t){return[this.$createElement("tr",t)]}},render(){return this.genTable("v-date-picker-table v-date-picker-table--date",[this.genTHead(),this.genTBody()],this.calculateTableDate)}}),Ht=f(Pe).extend({name:"v-date-picker-month-table",computed:{formatter(){return this.format||C(this.currentLocale,{month:"short",timeZone:"UTC"},{start:5,length:2})}},methods:{calculateTableDate(t){return`${parseInt(this.tableDate,10)+Math.sign(t||1)}`},genTBody(){const t=[],e=Array(3).fill(null),i=12/e.length;for(let s=0;s<i;s++){const n=e.map((a,r)=>{const l=s*e.length+r,o=`${this.displayedYear}-${d(l+1)}`;return this.$createElement("td",{key:l},[this.genButton(o,!1,"month",this.formatter)])});t.push(this.$createElement("tr",{key:s},n))}return this.$createElement("tbody",t)}},render(){return this.genTable("v-date-picker-table v-date-picker-table--month",[this.genTBody()],this.calculateTableDate)}});const Kt=f(w,W).extend({name:"v-date-picker-years",props:{format:Function,min:[Number,String],max:[Number,String],readonly:Boolean,value:[Number,String]},data(){return{defaultColor:"primary"}},computed:{formatter(){return this.format||C(this.currentLocale,{year:"numeric",timeZone:"UTC"},{length:4})}},mounted(){setTimeout(()=>{const t=this.$el.getElementsByClassName("active")[0];t?this.$el.scrollTop=t.offsetTop-this.$el.offsetHeight/2+t.offsetHeight/2:this.min&&!this.max?this.$el.scrollTop=this.$el.scrollHeight:!this.min&&this.max?this.$el.scrollTop=0:this.$el.scrollTop=this.$el.scrollHeight/2-this.$el.offsetHeight/2})},methods:{genYearItem(t){const e=this.formatter(`${t}`),i=parseInt(this.value,10)===t,s=i&&(this.color||"primary");return this.$createElement("li",this.setTextColor(s,{key:t,class:{active:i},on:te({click:()=>this.$emit("input",t)},Ce(this,":year",t))}),e)},genYearItems(){const t=[],e=this.value?parseInt(this.value,10):new Date().getFullYear(),i=this.max?parseInt(this.max,10):e+100,s=Math.min(i,this.min?parseInt(this.min,10):e-100);for(let n=i;n>=s;n--)t.push(this.genYearItem(n));return t}},render(){return this.$createElement("ul",{staticClass:"v-date-picker-years",ref:"years"},this.genYearItems())}});const Gt=f(w,ge,z).extend({name:"v-picker",props:{flat:Boolean,fullWidth:Boolean,landscape:Boolean,noTitle:Boolean,transition:{type:String,default:"fade-transition"},width:{type:[Number,String],default:290}},computed:{computedTitleColor(){const t=this.isDark?!1:this.color||"primary";return this.color||t}},methods:{genTitle(){return this.$createElement("div",this.setBackgroundColor(this.computedTitleColor,{staticClass:"v-picker__title",class:{"v-picker__title--landscape":this.landscape}}),this.$slots.title)},genBodyTransition(){return this.$createElement("transition",{props:{name:this.transition}},this.$slots.default)},genBody(){return this.$createElement("div",{staticClass:"v-picker__body",class:{"v-picker__body--no-title":this.noTitle,...this.themeClasses},style:this.fullWidth?void 0:{width:Ke(this.width)}},[this.genBodyTransition()])},genActions(){return this.$createElement("div",{staticClass:"v-picker__actions v-card__actions",class:{"v-picker__actions--no-title":this.noTitle}},this.$slots.actions)}},render(t){return t("div",{staticClass:"v-picker v-card",class:{"v-picker--flat":this.flat,"v-picker--landscape":this.landscape,"v-picker--full-width":this.fullWidth,...this.themeClasses,...this.elevationClasses}},[this.$slots.title?this.genTitle():null,this.genBody(),this.$slots.actions?this.genActions():null])}}),Zt=f(w,ge,z).extend({name:"picker",props:{flat:Boolean,fullWidth:Boolean,headerColor:String,landscape:Boolean,noTitle:Boolean,width:{type:[Number,String],default:290}},methods:{genPickerTitle(){return null},genPickerBody(){return null},genPickerActionsSlot(){return this.$scopedSlots.default?this.$scopedSlots.default({save:this.save,cancel:this.cancel}):this.$slots.default},genPicker(t){const e=[];if(!this.noTitle){const s=this.genPickerTitle();s&&e.push(s)}const i=this.genPickerBody();return i&&e.push(i),e.push(this.$createElement("template",{slot:"actions"},[this.genPickerActionsSlot()])),this.$createElement(Gt,{staticClass:t,props:{color:this.headerColor||this.color,dark:this.dark,elevation:this.elevation,flat:this.flat,fullWidth:this.fullWidth,landscape:this.landscape,light:this.light,width:this.width,noTitle:this.noTitle}},e)}}}),Jt=f(W,Zt).extend({name:"v-date-picker",props:{activePicker:String,allowedDates:Function,dayFormat:Function,disabled:Boolean,events:{type:[Array,Function,Object],default:()=>null},eventColor:{type:[Array,Function,Object,String],default:()=>"warning"},firstDayOfWeek:{type:[String,Number],default:0},headerDateFormat:Function,localeFirstDayOfYear:{type:[String,Number],default:0},max:String,min:String,monthFormat:Function,multiple:Boolean,nextIcon:{type:String,default:"$next"},nextMonthAriaLabel:{type:String,default:"$vuetify.datePicker.nextMonthAriaLabel"},nextYearAriaLabel:{type:String,default:"$vuetify.datePicker.nextYearAriaLabel"},pickerDate:String,prevIcon:{type:String,default:"$prev"},prevMonthAriaLabel:{type:String,default:"$vuetify.datePicker.prevMonthAriaLabel"},prevYearAriaLabel:{type:String,default:"$vuetify.datePicker.prevYearAriaLabel"},range:Boolean,reactive:Boolean,readonly:Boolean,scrollable:Boolean,showCurrent:{type:[Boolean,String],default:!0},selectedItemsText:{type:String,default:"$vuetify.datePicker.itemsSelected"},showAdjacentMonths:Boolean,showWeek:Boolean,titleDateFormat:Function,type:{type:String,default:"date",validator:t=>["date","month"].includes(t)},value:[Array,String],weekdayFormat:Function,yearFormat:Function,yearIcon:String},data(){const t=new Date;return{internalActivePicker:this.type.toUpperCase(),inputDay:null,inputMonth:null,inputYear:null,isReversing:!1,now:t,tableDate:(()=>{if(this.pickerDate)return this.pickerDate;const e=L(this.value),i=e[e.length-1]||(typeof this.showCurrent=="string"?this.showCurrent:`${t.getFullYear()}-${t.getMonth()+1}`);return m(i,this.type==="date"?"month":"year")})()}},computed:{multipleValue(){return L(this.value)},isMultiple(){return this.multiple||this.range},lastValue(){return this.isMultiple?this.multipleValue[this.multipleValue.length-1]:this.value},selectedMonths(){return!this.value||this.type==="month"?this.value:this.isMultiple?this.multipleValue.map(t=>t.substr(0,7)):this.value.substr(0,7)},current(){return this.showCurrent===!0?m(`${this.now.getFullYear()}-${this.now.getMonth()+1}-${this.now.getDate()}`,this.type):this.showCurrent||null},inputDate(){return this.type==="date"?`${this.inputYear}-${d(this.inputMonth+1)}-${d(this.inputDay)}`:`${this.inputYear}-${d(this.inputMonth+1)}`},tableMonth(){return Number((this.pickerDate||this.tableDate).split("-")[1])-1},tableYear(){return Number((this.pickerDate||this.tableDate).split("-")[0])},minMonth(){return this.min?m(this.min,"month"):null},maxMonth(){return this.max?m(this.max,"month"):null},minYear(){return this.min?m(this.min,"year"):null},maxYear(){return this.max?m(this.max,"year"):null},formatters(){return{year:this.yearFormat||C(this.currentLocale,{year:"numeric",timeZone:"UTC"},{length:4}),titleDate:this.titleDateFormat||(this.isMultiple?this.defaultTitleMultipleDateFormatter:this.defaultTitleDateFormatter)}},defaultTitleMultipleDateFormatter(){return t=>t.length?t.length===1?this.defaultTitleDateFormatter(t[0]):this.$vuetify.lang.t(this.selectedItemsText,t.length):"-"},defaultTitleDateFormatter(){const t={year:{year:"numeric",timeZone:"UTC"},month:{month:"long",timeZone:"UTC"},date:{weekday:"short",month:"short",day:"numeric",timeZone:"UTC"}},e=C(this.currentLocale,t[this.type],{start:0,length:{date:10,month:7,year:4}[this.type]}),i=s=>e(s).replace(/([^\d\s])([\d])/g,(n,a,r)=>`${a} ${r}`).replace(", ",",<br>");return this.landscape?i:e}},watch:{internalActivePicker:{immediate:!0,handler(t){this.$emit("update:active-picker",t)}},activePicker(t){this.internalActivePicker=t},tableDate(t,e){const i=this.type==="month"?"year":"month";this.isReversing=m(t,i)<m(e,i),this.$emit("update:picker-date",t)},pickerDate(t){t?this.tableDate=t:this.lastValue&&this.type==="date"?this.tableDate=m(this.lastValue,"month"):this.lastValue&&this.type==="month"&&(this.tableDate=m(this.lastValue,"year"))},value(t,e){this.checkMultipleProp(),this.setInputDate(),(!this.isMultiple&&this.value&&!this.pickerDate||this.isMultiple&&this.multipleValue.length&&(!e||!e.length)&&!this.pickerDate)&&(this.tableDate=m(this.inputDate,this.type==="month"?"year":"month"))},type(t){if(this.internalActivePicker=t.toUpperCase(),this.value&&this.value.length){const e=this.multipleValue.map(i=>m(i,t)).filter(this.isDateAllowed);this.$emit("input",this.isMultiple?e:e[0])}}},created(){this.checkMultipleProp(),this.pickerDate!==this.tableDate&&this.$emit("update:picker-date",this.tableDate),this.setInputDate()},methods:{emitInput(t){if(this.range){if(this.multipleValue.length!==1)this.$emit("input",[t]);else{const i=[this.multipleValue[0],t];this.$emit("input",i),this.$emit("change",i)}return}const e=this.multiple?this.multipleValue.indexOf(t)===-1?this.multipleValue.concat([t]):this.multipleValue.filter(i=>i!==t):t;this.$emit("input",e),this.multiple||this.$emit("change",t)},checkMultipleProp(){if(this.value==null)return;const t=this.value.constructor.name,e=this.isMultiple?"Array":"String";t!==e&&ve(`Value must be ${this.isMultiple?"an":"a"} ${e}, got ${t}`,this)},isDateAllowed(t){return De(t,this.min,this.max,this.allowedDates)},yearClick(t){this.inputYear=t,this.type==="month"?this.tableDate=`${t}`:this.tableDate=`${t}-${d((this.tableMonth||0)+1)}`,this.internalActivePicker="MONTH",this.reactive&&!this.readonly&&!this.isMultiple&&this.isDateAllowed(this.inputDate)&&this.$emit("input",this.inputDate)},monthClick(t){const[e,i]=t.split("-");this.inputYear=parseInt(e,10),this.inputMonth=parseInt(i,10)-1,this.type==="date"?(this.inputDay&&(this.inputDay=Math.min(this.inputDay,Yt(this.inputYear,this.inputMonth+1))),this.tableDate=t,this.internalActivePicker="DATE",this.reactive&&!this.readonly&&!this.isMultiple&&this.isDateAllowed(this.inputDate)&&this.$emit("input",this.inputDate)):this.emitInput(this.inputDate)},dateClick(t){const[e,i,s]=t.split("-");this.inputYear=parseInt(e,10),this.inputMonth=parseInt(i,10)-1,this.inputDay=parseInt(s,10),this.emitInput(this.inputDate)},genPickerTitle(){return this.$createElement(jt,{props:{date:this.value?this.formatters.titleDate(this.isMultiple?this.multipleValue:this.value):"",disabled:this.disabled,readonly:this.readonly,selectingYear:this.internalActivePicker==="YEAR",year:this.formatters.year(this.multipleValue.length?`${this.inputYear}`:this.tableDate),yearIcon:this.yearIcon,value:this.multipleValue[0]},slot:"title",on:{"update:selecting-year":t=>this.internalActivePicker=t?"YEAR":this.type.toUpperCase()}})},genTableHeader(){return this.$createElement(qt,{props:{nextIcon:this.nextIcon,color:this.color,dark:this.dark,disabled:this.disabled,format:this.headerDateFormat,light:this.light,locale:this.locale,min:this.internalActivePicker==="DATE"?this.minMonth:this.minYear,max:this.internalActivePicker==="DATE"?this.maxMonth:this.maxYear,nextAriaLabel:this.internalActivePicker==="DATE"?this.nextMonthAriaLabel:this.nextYearAriaLabel,prevAriaLabel:this.internalActivePicker==="DATE"?this.prevMonthAriaLabel:this.prevYearAriaLabel,prevIcon:this.prevIcon,readonly:this.readonly,value:this.internalActivePicker==="DATE"?`${d(this.tableYear,4)}-${d(this.tableMonth+1)}`:`${d(this.tableYear,4)}`},on:{toggle:()=>this.internalActivePicker=this.internalActivePicker==="DATE"?"MONTH":"YEAR",input:t=>this.tableDate=t}})},genDateTable(){return this.$createElement(Wt,{props:{allowedDates:this.allowedDates,color:this.color,current:this.current,dark:this.dark,disabled:this.disabled,events:this.events,eventColor:this.eventColor,firstDayOfWeek:this.firstDayOfWeek,format:this.dayFormat,light:this.light,locale:this.locale,localeFirstDayOfYear:this.localeFirstDayOfYear,min:this.min,max:this.max,range:this.range,readonly:this.readonly,scrollable:this.scrollable,showAdjacentMonths:this.showAdjacentMonths,showWeek:this.showWeek,tableDate:`${d(this.tableYear,4)}-${d(this.tableMonth+1)}`,value:this.value,weekdayFormat:this.weekdayFormat},ref:"table",on:{input:this.dateClick,"update:table-date":t=>this.tableDate=t,...J(this,":date")}})},genMonthTable(){return this.$createElement(Ht,{props:{allowedDates:this.type==="month"?this.allowedDates:null,color:this.color,current:this.current?m(this.current,"month"):null,dark:this.dark,disabled:this.disabled,events:this.type==="month"?this.events:null,eventColor:this.type==="month"?this.eventColor:null,format:this.monthFormat,light:this.light,locale:this.locale,min:this.minMonth,max:this.maxMonth,range:this.range,readonly:this.readonly&&this.type==="month",scrollable:this.scrollable,value:this.selectedMonths,tableDate:`${d(this.tableYear,4)}`},ref:"table",on:{input:this.monthClick,"update:table-date":t=>this.tableDate=t,...J(this,":month")}})},genYears(){return this.$createElement(Kt,{props:{color:this.color,format:this.yearFormat,locale:this.locale,min:this.minYear,max:this.maxYear,value:this.tableYear},on:{input:this.yearClick,...J(this,":year")}})},genPickerBody(){const t=this.internalActivePicker==="YEAR"?[this.genYears()]:[this.genTableHeader(),this.internalActivePicker==="DATE"?this.genDateTable():this.genMonthTable()];return this.$createElement("div",{key:this.internalActivePicker},t)},setInputDate(){if(this.lastValue){const t=this.lastValue.split("-");this.inputYear=parseInt(t[0],10),this.inputMonth=parseInt(t[1],10)-1,this.type==="date"&&(this.inputDay=parseInt(t[2],10))}else this.inputYear=this.inputYear||this.now.getFullYear(),this.inputMonth=this.inputMonth==null?this.inputMonth:this.now.getMonth(),this.inputDay=this.inputDay||this.now.getDate()}},render(){return this.genPicker("v-picker--date")}});const Xt=_.extend({name:"v-file-input",model:{prop:"value",event:"change"},props:{chips:Boolean,clearable:{type:Boolean,default:!0},counterSizeString:{type:String,default:"$vuetify.fileInput.counterSize"},counterString:{type:String,default:"$vuetify.fileInput.counter"},hideInput:Boolean,multiple:Boolean,placeholder:String,prependIcon:{type:String,default:"$file"},readonly:{type:Boolean,default:!1},showSize:{type:[Boolean,Number],default:!1,validator:t=>typeof t=="boolean"||[1e3,1024].includes(t)},smallChips:Boolean,truncateLength:{type:[Number,String],default:22},type:{type:String,default:"file"},value:{default:void 0,validator:t=>L(t).every(e=>e!=null&&typeof e=="object")}},computed:{classes(){return{..._.options.computed.classes.call(this),"v-file-input":!0}},computedCounterValue(){const t=this.multiple&&this.lazyValue?this.lazyValue.length:this.lazyValue instanceof File?1:0;if(!this.showSize)return this.$vuetify.lang.t(this.counterString,t);const e=this.internalArrayValue.reduce((i,{size:s=0})=>i+s,0);return this.$vuetify.lang.t(this.counterSizeString,t,he(e,this.base===1024))},internalArrayValue(){return L(this.internalValue)},internalValue:{get(){return this.lazyValue},set(t){this.lazyValue=t,this.$emit("change",this.lazyValue)}},isDirty(){return this.internalArrayValue.length>0},isLabelActive(){return this.isDirty},text(){return!this.isDirty&&(this.persistentPlaceholder||this.isFocused||!this.hasLabel)?[this.placeholder]:this.internalArrayValue.map(t=>{const{name:e="",size:i=0}=t,s=this.truncateText(e);return this.showSize?`${s} (${he(i,this.base===1024)})`:s})},base(){return typeof this.showSize!="boolean"?this.showSize:void 0},hasChips(){return this.chips||this.smallChips}},watch:{readonly:{handler(t){t===!0&&Ge("readonly is not supported on <v-file-input>",this)},immediate:!0},value(t){const e=this.multiple?t:t?[t]:[];Q(e,this.$refs.input.files)||(this.$refs.input.value="")}},methods:{clearableCallback(){this.internalValue=this.multiple?[]:null,this.$refs.input.value=""},genChips(){return this.isDirty?this.text.map((t,e)=>this.$createElement($e,{props:{small:this.smallChips},on:{"click:close":()=>{const i=this.internalValue;i.splice(e,1),this.internalValue=i}}},[t])):[]},genControl(){const t=_.options.methods.genControl.call(this);return this.hideInput&&(t.data.style=Ze(t.data.style,{display:"none"})),t},genInput(){const t=_.options.methods.genInput.call(this);return t.data.attrs.multiple=this.multiple,delete t.data.domProps.value,delete t.data.on.input,t.data.on.change=this.onInput,[this.genSelections(),t]},genPrependSlot(){if(!this.prependIcon)return null;const t=this.genIcon("prepend",()=>{this.$refs.input.click()});return this.genSlot("prepend","outer",[t])},genSelectionText(){const t=this.text.length;return t<2?this.text:this.showSize&&!this.counter?[this.computedCounterValue]:[this.$vuetify.lang.t(this.counterString,t)]},genSelections(){const t=[];return this.isDirty&&this.$scopedSlots.selection?this.internalArrayValue.forEach((e,i)=>{!this.$scopedSlots.selection||t.push(this.$scopedSlots.selection({text:this.text[i],file:e,index:i}))}):t.push(this.hasChips&&this.isDirty?this.genChips():this.genSelectionText()),this.$createElement("div",{staticClass:"v-file-input__text",class:{"v-file-input__text--placeholder":this.placeholder&&!this.isDirty,"v-file-input__text--chips":this.hasChips&&!this.$scopedSlots.selection}},t)},genTextFieldSlot(){const t=_.options.methods.genTextFieldSlot.call(this);return t.data.on={...t.data.on||{},click:e=>{e.target&&e.target.nodeName==="LABEL"||this.$refs.input.click()}},t},onInput(t){const e=[...t.target.files||[]];this.internalValue=this.multiple?e:e[0],this.initialValue=this.internalValue},onKeyDown(t){this.$emit("keydown",t)},truncateText(t){if(t.length<Number(this.truncateLength))return t;const e=Math.floor((Number(this.truncateLength)-1)/2);return`${t.slice(0,e)}\u2026${t.slice(t.length-e)}`}}});const Qt=f(F,x),ei=Qt.extend({name:"v-radio-group",provide(){return{radioGroup:this}},props:{column:{type:Boolean,default:!0},height:{type:[Number,String],default:"auto"},name:String,row:Boolean,value:null},computed:{classes(){return{...x.options.computed.classes.call(this),"v-input--selection-controls v-input--radio-group":!0,"v-input--radio-group--column":this.column&&!this.row,"v-input--radio-group--row":this.row}}},methods:{genDefaultSlot(){return this.$createElement("div",{staticClass:"v-input--radio-group__input",attrs:{id:this.id,role:"radiogroup","aria-labelledby":this.computedId}},x.options.methods.genDefaultSlot.call(this))},genInputSlot(){const t=x.options.methods.genInputSlot.call(this);return delete t.data.on.click,t},genLabel(){const t=x.options.methods.genLabel.call(this);return t?(t.data.attrs.id=this.computedId,delete t.data.attrs.for,t.tag="legend",t):null},onClick:F.options.methods.onClick},render(t){const e=x.options.render.call(this,t);return this._b(e.data,"div",this.attrs$),e}});const ti=f(it,w,tt,et("radioGroup"),z),ue=ti.extend().extend({name:"v-radio",inheritAttrs:!1,props:{disabled:Boolean,id:String,label:String,name:String,offIcon:{type:String,default:"$radioOff"},onIcon:{type:String,default:"$radioOn"},readonly:Boolean,value:{default:null}},data:()=>({isFocused:!1}),computed:{classes(){return{"v-radio--is-disabled":this.isDisabled,"v-radio--is-focused":this.isFocused,...this.themeClasses,...this.groupClasses}},computedColor(){if(!this.isDisabled)return H.options.computed.computedColor.call(this)},computedIcon(){return this.isActive?this.onIcon:this.offIcon},computedId(){return x.options.computed.computedId.call(this)},hasLabel:x.options.computed.hasLabel,hasState(){return(this.radioGroup||{}).hasState},isDisabled(){return this.disabled||!!this.radioGroup&&this.radioGroup.isDisabled},isReadonly(){return this.readonly||!!this.radioGroup&&this.radioGroup.isReadonly},computedName(){return this.name||!this.radioGroup?this.name:this.radioGroup.name||`radio-${this.radioGroup._uid}`},rippleState(){return H.options.computed.rippleState.call(this)},validationState(){return(this.radioGroup||{}).validationState||this.computedColor}},methods:{genInput(t){return H.options.methods.genInput.call(this,"radio",t)},genLabel(){return this.hasLabel?this.$createElement(Je,{on:{click:Xe},attrs:{for:this.computedId},props:{color:this.validationState,focused:this.hasState}},Qe(this,"label")||this.label):null},genRadio(){const{title:t,...e}=this.attrs$;return this.$createElement("div",{staticClass:"v-input--selection-controls__input"},[this.$createElement(p,this.setTextColor(this.validationState,{props:{dense:this.radioGroup&&this.radioGroup.dense}}),this.computedIcon),this.genInput({name:this.computedName,value:this.value,...e}),this.genRipple(this.setTextColor(this.rippleState))])},onFocus(t){this.isFocused=!0,this.$emit("focus",t)},onBlur(t){this.isFocused=!1,this.$emit("blur",t)},onChange(){this.isDisabled||this.isReadonly||this.isActive||this.toggle()},onKeydown:()=>{}},render(t){const e={staticClass:"v-radio",class:this.classes,on:te({click:this.onChange},this.listeners$),attrs:{title:this.attrs$.title}};return t("div",e,[this.genRadio(),this.genLabel()])}});const ii=f(w,st("treeview")),ze={activatable:Boolean,activeClass:{type:String,default:"v-treeview-node--active"},color:{type:String,default:"primary"},disablePerNode:Boolean,expandIcon:{type:String,default:"$subgroup"},indeterminateIcon:{type:String,default:"$checkboxIndeterminate"},itemChildren:{type:String,default:"children"},itemDisabled:{type:String,default:"disabled"},itemKey:{type:String,default:"id"},itemText:{type:String,default:"name"},loadChildren:Function,loadingIcon:{type:String,default:"$loading"},offIcon:{type:String,default:"$checkboxOff"},onIcon:{type:String,default:"$checkboxOn"},openOnClick:Boolean,rounded:Boolean,selectable:Boolean,selectedColor:{type:String,default:"accent"},shaped:Boolean,transition:Boolean,selectionType:{type:String,default:"leaf",validator:t=>["leaf","independent"].includes(t)}},Ie=ii.extend().extend({name:"v-treeview-node",inject:{treeview:{default:null}},props:{level:Number,item:{type:Object,default:()=>null},parentIsDisabled:Boolean,...ze},data:()=>({hasLoaded:!1,isActive:!1,isIndeterminate:!1,isLoading:!1,isOpen:!1,isSelected:!1}),computed:{disabled(){return h(this.item,this.itemDisabled)||!this.disablePerNode&&this.parentIsDisabled&&this.selectionType==="leaf"},key(){return h(this.item,this.itemKey)},children(){const t=h(this.item,this.itemChildren);return t&&t.filter(e=>!this.treeview.isExcluded(h(e,this.itemKey)))},text(){return h(this.item,this.itemText)},scopedProps(){return{item:this.item,leaf:!this.children,selected:this.isSelected,indeterminate:this.isIndeterminate,active:this.isActive,open:this.isOpen}},computedIcon(){return this.isIndeterminate?this.indeterminateIcon:this.isSelected?this.onIcon:this.offIcon},hasChildren(){return!!this.children&&(!!this.children.length||!!this.loadChildren)}},created(){this.treeview.register(this)},beforeDestroy(){this.treeview.unregister(this)},methods:{checkChildren(){return new Promise(t=>{if(!this.children||this.children.length||!this.loadChildren||this.hasLoaded)return t();this.isLoading=!0,t(this.loadChildren(this.item))}).then(()=>{this.isLoading=!1,this.hasLoaded=!0})},open(){this.isOpen=!this.isOpen,this.treeview.updateOpen(this.key,this.isOpen),this.treeview.emitOpen()},genLabel(){const t=[];return this.$scopedSlots.label?t.push(this.$scopedSlots.label(this.scopedProps)):t.push(this.text),this.$createElement("div",{slot:"label",staticClass:"v-treeview-node__label"},t)},genPrependSlot(){return this.$scopedSlots.prepend?this.$createElement("div",{staticClass:"v-treeview-node__prepend"},this.$scopedSlots.prepend(this.scopedProps)):null},genAppendSlot(){return this.$scopedSlots.append?this.$createElement("div",{staticClass:"v-treeview-node__append"},this.$scopedSlots.append(this.scopedProps)):null},genContent(){const t=[this.genPrependSlot(),this.genLabel(),this.genAppendSlot()];return this.$createElement("div",{staticClass:"v-treeview-node__content"},t)},genToggle(){return this.$createElement(p,{staticClass:"v-treeview-node__toggle",class:{"v-treeview-node__toggle--open":this.isOpen,"v-treeview-node__toggle--loading":this.isLoading},slot:"prepend",on:{click:t=>{t.stopPropagation(),!this.isLoading&&this.checkChildren().then(()=>this.open())}}},[this.isLoading?this.loadingIcon:this.expandIcon])},genCheckbox(){return this.$createElement(p,{staticClass:"v-treeview-node__checkbox",props:{color:this.isSelected||this.isIndeterminate?this.selectedColor:void 0,disabled:this.disabled},on:{click:t=>{t.stopPropagation(),!this.isLoading&&this.checkChildren().then(()=>{this.$nextTick(()=>{this.isSelected=!this.isSelected,this.isIndeterminate=!1,this.treeview.updateSelected(this.key,this.isSelected),this.treeview.emitSelected()})})}}},[this.computedIcon])},genLevel(t){return X(t).map(()=>this.$createElement("div",{staticClass:"v-treeview-node__level"}))},genNode(){const t=[this.genContent()];return this.selectable&&t.unshift(this.genCheckbox()),this.hasChildren?t.unshift(this.genToggle()):t.unshift(...this.genLevel(1)),t.unshift(...this.genLevel(this.level)),this.$createElement("div",this.setTextColor(this.isActive&&this.color,{staticClass:"v-treeview-node__root",class:{[this.activeClass]:this.isActive},on:{click:()=>{this.openOnClick&&this.hasChildren?this.checkChildren().then(this.open):this.activatable&&!this.disabled&&(this.isActive=!this.isActive,this.treeview.updateActive(this.key,this.isActive),this.treeview.emitActive())}}}),t)},genChild(t,e){return this.$createElement(Ie,{key:h(t,this.itemKey),props:{activatable:this.activatable,activeClass:this.activeClass,item:t,selectable:this.selectable,selectedColor:this.selectedColor,color:this.color,disablePerNode:this.disablePerNode,expandIcon:this.expandIcon,indeterminateIcon:this.indeterminateIcon,offIcon:this.offIcon,onIcon:this.onIcon,loadingIcon:this.loadingIcon,itemKey:this.itemKey,itemText:this.itemText,itemDisabled:this.itemDisabled,itemChildren:this.itemChildren,loadChildren:this.loadChildren,transition:this.transition,openOnClick:this.openOnClick,rounded:this.rounded,shaped:this.shaped,level:this.level+1,selectionType:this.selectionType,parentIsDisabled:e},scopedSlots:this.$scopedSlots})},genChildrenWrapper(){if(!this.isOpen||!this.children)return null;const t=[this.children.map(e=>this.genChild(e,this.disabled))];return this.$createElement("div",{staticClass:"v-treeview-node__children"},t)},genTransition(){return this.$createElement(nt,[this.genChildrenWrapper()])}},render(t){const e=[this.genNode()];return this.transition?e.push(this.genTransition()):e.push(this.genChildrenWrapper()),t("div",{staticClass:"v-treeview-node",class:{"v-treeview-node--leaf":!this.hasChildren,"v-treeview-node--click":this.openOnClick,"v-treeview-node--disabled":this.disabled,"v-treeview-node--rounded":this.rounded,"v-treeview-node--shaped":this.shaped,"v-treeview-node--selected":this.isSelected},attrs:{"aria-expanded":String(this.isOpen)}},e)}}),si=Ie;function ni(t,e,i){return h(t,i).toLocaleLowerCase().indexOf(e.toLocaleLowerCase())>-1}function Ae(t,e,i,s,n,a,r){if(t(e,i,n))return!0;const l=h(e,a);if(l){let o=!1;for(let u=0;u<l.length;u++)Ae(t,l[u],i,s,n,a,r)&&(o=!0);if(o)return!0}return r.add(h(e,s)),!1}const ai=f(at("treeview"),z).extend({name:"v-treeview",provide(){return{treeview:this}},props:{active:{type:Array,default:()=>[]},dense:Boolean,disabled:Boolean,filter:Function,hoverable:Boolean,items:{type:Array,default:()=>[]},multipleActive:Boolean,open:{type:Array,default:()=>[]},openAll:Boolean,returnObject:{type:Boolean,default:!1},search:String,value:{type:Array,default:()=>[]},...ze},data:()=>({level:-1,activeCache:new Set,nodes:{},openCache:new Set,selectedCache:new Set}),computed:{excludedItems(){const t=new Set;if(!this.search)return t;for(let e=0;e<this.items.length;e++)Ae(this.filter||ni,this.items[e],this.search,this.itemKey,this.itemText,this.itemChildren,t);return t}},watch:{items:{handler(){const t=Object.keys(this.nodes).map(n=>h(this.nodes[n].item,this.itemKey)),e=this.getKeys(this.items),i=rt(e,t);if(!i.length&&e.length<t.length)return;i.forEach(n=>delete this.nodes[n]);const s=[...this.selectedCache];this.selectedCache=new Set,this.activeCache=new Set,this.openCache=new Set,this.buildTree(this.items),Q(s,[...this.selectedCache])||this.emitSelected()},deep:!0},active(t){this.handleNodeCacheWatcher(t,this.activeCache,this.updateActive,this.emitActive)},value(t){this.handleNodeCacheWatcher(t,this.selectedCache,this.updateSelected,this.emitSelected)},open(t){this.handleNodeCacheWatcher(t,this.openCache,this.updateOpen,this.emitOpen)}},created(){const t=e=>this.returnObject?h(e,this.itemKey):e;this.buildTree(this.items);for(const e of this.value.map(t))this.updateSelected(e,!0,!0);for(const e of this.active.map(t))this.updateActive(e,!0)},mounted(){(this.$slots.prepend||this.$slots.append)&&ve("The prepend and append slots require a slot-scope attribute",this),this.openAll?this.updateAll(!0):(this.open.forEach(t=>this.updateOpen(this.returnObject?h(t,this.itemKey):t,!0)),this.emitOpen())},methods:{updateAll(t){Object.keys(this.nodes).forEach(e=>this.updateOpen(h(this.nodes[e].item,this.itemKey),t)),this.emitOpen()},getKeys(t,e=[]){for(let i=0;i<t.length;i++){const s=h(t[i],this.itemKey);e.push(s);const n=h(t[i],this.itemChildren);n&&e.push(...this.getKeys(n))}return e},buildTree(t,e=null){var i;for(let s=0;s<t.length;s++){const n=t[s],a=h(n,this.itemKey),r=(i=h(n,this.itemChildren))!==null&&i!==void 0?i:[],l=this.nodes.hasOwnProperty(a)?this.nodes[a]:{isSelected:!1,isIndeterminate:!1,isActive:!1,isOpen:!1,vnode:null},o={vnode:l.vnode,parent:e,children:r.map(u=>h(u,this.itemKey)),item:n};if(this.buildTree(r,a),this.selectionType!=="independent"&&e!==null&&!this.nodes.hasOwnProperty(a)&&this.nodes.hasOwnProperty(e)?o.isSelected=this.nodes[e].isSelected:(o.isSelected=l.isSelected,o.isIndeterminate=l.isIndeterminate),o.isActive=l.isActive,o.isOpen=l.isOpen,this.nodes[a]=o,r.length&&this.selectionType!=="independent"){const{isSelected:u,isIndeterminate:y}=this.calculateState(a,this.nodes);o.isSelected=u,o.isIndeterminate=y}this.nodes[a].isSelected&&(this.selectionType==="independent"||o.children.length===0)&&this.selectedCache.add(a),this.nodes[a].isActive&&this.activeCache.add(a),this.nodes[a].isOpen&&this.openCache.add(a),this.updateVnodeState(a)}},calculateState(t,e){const i=e[t].children,s=i.reduce((r,l)=>(r[0]+=+Boolean(e[l].isSelected),r[1]+=+Boolean(e[l].isIndeterminate),r),[0,0]),n=!!i.length&&s[0]===i.length,a=!n&&(s[0]>0||s[1]>0);return{isSelected:n,isIndeterminate:a}},emitOpen(){this.emitNodeCache("update:open",this.openCache)},emitSelected(){this.emitNodeCache("input",this.selectedCache)},emitActive(){this.emitNodeCache("update:active",this.activeCache)},emitNodeCache(t,e){this.$emit(t,this.returnObject?[...e].map(i=>this.nodes[i].item):[...e])},handleNodeCacheWatcher(t,e,i,s){t=this.returnObject?t.map(a=>h(a,this.itemKey)):t;const n=[...e];Q(n,t)||(n.forEach(a=>i(a,!1)),t.forEach(a=>i(a,!0)),s())},getDescendants(t,e=[]){const i=this.nodes[t].children;e.push(...i);for(let s=0;s<i.length;s++)e=this.getDescendants(i[s],e);return e},getParents(t){let e=this.nodes[t].parent;const i=[];for(;e!==null;)i.push(e),e=this.nodes[e].parent;return i},register(t){const e=h(t.item,this.itemKey);this.nodes[e].vnode=t,this.updateVnodeState(e)},unregister(t){const e=h(t.item,this.itemKey);this.nodes[e]&&(this.nodes[e].vnode=null)},isParent(t){return this.nodes[t].children&&this.nodes[t].children.length},updateActive(t,e){if(!this.nodes.hasOwnProperty(t))return;this.multipleActive||this.activeCache.forEach(s=>{this.nodes[s].isActive=!1,this.updateVnodeState(s),this.activeCache.delete(s)});const i=this.nodes[t];!i||(e?this.activeCache.add(t):this.activeCache.delete(t),i.isActive=e,this.updateVnodeState(t))},updateSelected(t,e,i=!1){if(!this.nodes.hasOwnProperty(t))return;const s=new Map;if(this.selectionType!=="independent"){for(const a of this.getDescendants(t))(!h(this.nodes[a].item,this.itemDisabled)||i)&&(this.nodes[a].isSelected=e,this.nodes[a].isIndeterminate=!1,s.set(a,e));const n=this.calculateState(t,this.nodes);this.nodes[t].isSelected=e,this.nodes[t].isIndeterminate=n.isIndeterminate,s.set(t,e);for(const a of this.getParents(t)){const r=this.calculateState(a,this.nodes);this.nodes[a].isSelected=r.isSelected,this.nodes[a].isIndeterminate=r.isIndeterminate,s.set(a,r.isSelected)}}else this.nodes[t].isSelected=e,this.nodes[t].isIndeterminate=!1,s.set(t,e);for(const[n,a]of s.entries())this.updateVnodeState(n),!(this.selectionType==="leaf"&&this.isParent(n))&&(a===!0?this.selectedCache.add(n):this.selectedCache.delete(n))},updateOpen(t,e){if(!this.nodes.hasOwnProperty(t))return;const i=this.nodes[t],s=h(i.item,this.itemChildren);s&&!s.length&&i.vnode&&!i.vnode.hasLoaded?i.vnode.checkChildren().then(()=>this.updateOpen(t,e)):s&&s.length&&(i.isOpen=e,i.isOpen?this.openCache.add(t):this.openCache.delete(t),this.updateVnodeState(t))},updateVnodeState(t){const e=this.nodes[t];e&&e.vnode&&(e.vnode.isSelected=e.isSelected,e.vnode.isIndeterminate=e.isIndeterminate,e.vnode.isActive=e.isActive,e.vnode.isOpen=e.isOpen)},isExcluded(t){return!!this.search&&this.excludedItems.has(t)}},render(t){const e=this.items.length?this.items.filter(i=>!this.isExcluded(h(i,this.itemKey))).map(i=>si.options.methods.genChild.bind(this)(i,this.disabled||h(i,this.itemDisabled))):this.$slots.default;return t("div",{staticClass:"v-treeview",class:{"v-treeview--hoverable":this.hoverable,"v-treeview--dense":this.dense,...this.themeClasses}},e)}});const ri={components:{},props:{editable:{type:Boolean,default:!0},label:{type:String,required:!0},value:{type:[String,Number],default:""},dataType:{type:String,default:"string"},suggestedValues:{type:Array,default:()=>[]},strict:{type:Boolean,default:!1},rules:{type:Array,default:()=>[]}},data(){return{internalValue:this.value,editing:!1,menu:!1,original:"",moment:N}},computed:{dirty(){return this.original!==this.internalValue},...lt({isDarkMode:"application/isDarkMode"})},watch:{internalValue(t){this.$emit("input",t)}},mounted(){this.original=this.value},methods:{clicked(){!this.editable||(this.editing=!0,this.$nextTick(()=>{this.dataType==="date"||this.dataType==="date-range"?this.menu=!0:this.$refs.field.focus()}))},async update(){this.$refs.field.validate&&this.$refs.field.validate()===!1||(this.label==="Delay"?this.internalValue=Math.floor(this.internalValue):this.label==="Jitter"&&(this.internalValue=Math.floor(this.internalValue*10)/10),await this.$nextTick(),this.editing=!1,this.$emit("update"))},revert(){this.editing=!1,this.internalValue=this.original},async clear(){this.internalValue="",await this.$nextTick(),this.editing=!1,this.$emit("update")},getColClass(){return this.editing===!1&&this.editable===!0?this.isDarkMode?"column-not-editing-dark":"column-not-editing":""}}};var li=function(){var e=this,i=e._self._c;return i(O,{staticClass:"pb-5"},[i(T,{attrs:{cols:"4"}},[i("span",{staticClass:"text--bold"},[e._v(e._s(e.label))])]),i(T,{class:e.getColClass(),attrs:{cols:"6"},on:{click:e.clicked}},[e.editing&&e.editable?[e.suggestedValues.length>0&&e.strict?i(ke,{ref:"field",attrs:{items:e.suggestedValues,label:e.label,outlined:"",dense:""},on:{blur:e.update,keyup:function(s){return!s.type.indexOf("key")&&e._k(s.keyCode,"enter",13,s.key,"Enter")?null:e.update.apply(null,arguments)}},model:{value:e.internalValue,callback:function(s){e.internalValue=s},expression:"internalValue"}}):e.dataType==="date"||e.dataType==="date-range"?i(re,{ref:"menu",attrs:{"close-on-content-click":!1,transition:"scale-transition","offset-y":"","min-width":"auto"},scopedSlots:e._u([{key:"activator",fn:function({on:s,attrs:n}){return[i(_,e._g(e._b({ref:"field",attrs:{label:"Picker in menu","prepend-icon":"mdi-calendar",readonly:"",clearable:""},on:{"click:clear":e.clear},model:{value:e.internalValue,callback:function(a){e.internalValue=a},expression:"internalValue"}},"v-text-field",n,!1),s))]}}],null,!1,2992141911),model:{value:e.menu,callback:function(s){e.menu=s},expression:"menu"}},[i(Jt,{attrs:{outlined:"",dense:"",range:e.dataType==="date-range",min:e.moment().format("YYYY-MM-DD")},on:{blur:e.update,keyup:function(s){return!s.type.indexOf("key")&&e._k(s.keyCode,"enter",13,s.key,"Enter")?null:e.update.apply(null,arguments)}},model:{value:e.internalValue,callback:function(s){e.internalValue=s},expression:"internalValue"}},[i(I),i(v,{attrs:{text:"",color:"primary"},on:{click:function(s){e.menu=!1,e.editing=!1,e.revert()}}},[e._v(" Cancel ")]),i(v,{attrs:{text:"",color:"primary"},on:{click:function(s){e.menu=!1,e.update()}}},[e._v(" OK ")])],1)],1):e.dataType==="string"||e.dataType==="number"?i(_,{ref:"field",staticStyle:{"margin-bottom":"-45px"},attrs:{rules:e.rules,label:e.label,type:e.dataType==="string"?"text":"number",step:e.label==="Jitter"?"0.1":"1",max:e.label==="Jitter"?"1":"",min:"0",outlined:"",dense:"",required:""},on:{blur:e.update,keyup:function(s){return!s.type.indexOf("key")&&e._k(s.keyCode,"enter",13,s.key,"Enter")?null:e.update.apply(null,arguments)}},model:{value:e.internalValue,callback:function(s){e.internalValue=s},expression:"internalValue"}}):e._e()]:i("span",{staticClass:"ml-3"},[e._v(" "+e._s(e.internalValue)+" ")])],2)],1)},oi=[],hi=k(ri,li,oi,!1,null,null,null,null);const c=hi.exports;const di={components:{ClickToEdit:c},props:{agent:{type:Object,required:!0},readOnly:{type:Boolean,default:!1}},data(){return{valid:!0,nameLoading:!1,loading:!1,labelPosition:"left",rules:{},form:{},moment:N,workingHoursRules:[t=>/^[0-9]{1,2}:[0-5][0-9]-[0-9]{1,2}:[0-5][0-9]$/.test(t)||"Must be in the format 00:00-24:00"],nameRules:[t=>!!t||"Name is required",t=>!!t&&t.length>2||"Name must be at least 3 characters"],jitterRules:[t=>!Number.isNaN(t)||"Jitter must be a number",t=>t>=0&&t<=1||"Jitter must be between 0 and 1"],delayRules:[t=>!Number.isNaN(t)||"Delay must be a number",t=>t>=0||"Delay must be a positive number"]}},computed:{...ot({listeners:t=>t.listener.listeners}),fields(){return Object.keys(this.agent).map(t=>({name:t,Value:typeof this.agent[t]=="boolean"?`${this.agent[t]}`:this.agent[t]}))},requiredFields(){return this.fields.filter(t=>["name"].indexOf(t.name)<0)}},watch:{fields:{immediate:!0,handler(t){const e=t.reduce((i,s)=>{if(s.name==="kill_date"&&s.Value&&s.Value.length>0){const n=s.Value.split("/"),a=n[2],r=n[0],l=n[1];i[s.name]=`${a}-${r}-${l}`}else i[s.name]=s.Value;return i},{});P.set(this,"form",e)}}},mounted(){this.$store.dispatch("listener/getListeners")},methods:{async updateName(){if(this.agent.name!==this.form.name){try{await this.$store.dispatch("agent/rename",{sessionId:this.agent.session_id,newName:this.form.name})}catch(t){this.$snack.error(`Update agent listener failed: ${t}`);return}this.$snack.info(`Agent ${this.agent.name} name updated`)}},async updateListener(){if(this.agent.listener!==this.form.listener){try{const t=this.listeners.filter(e=>e.name===this.form.listener)[0].id;await ht(this.agent.session_id,t)}catch(t){this.$snack.error(`Update agent listener failed: ${t}`);return}this.$snack.info(`Tasked agent to change listener to: ${this.form.listener}`),await this.$store.dispatch("agent/getAgent",{sessionId:this.form.name})}},async updateKillDate(){let t="";if(this.form.kill_date&&this.form.kill_date.length>0&&(t=N(this.form.kill_date).format("MM/DD/YYYY")),this.agent.kill_date!==t){try{await dt(this.agent.session_id,t)}catch(e){this.$snack.error(`Update agent kill date failed: ${e}`);return}this.$snack.info(`Tasked agent to change kill date to: ${t}`),this.$store.dispatch("agent/getAgent",{sessionId:this.form.name})}},async updateWorkingHours(){if(this.agent.working_hours!==this.form.working_hours){try{await ut(this.agent.session_id,this.form.working_hours)}catch(t){this.$snack.error(`Update agent working hours failed: ${t}`);return}this.$snack.info(`Tasked agent to change working hours to: ${this.form.working_hours}`)}},async updateDelay(){if(this.agent.delay!==this.form.delay){try{await de(this.agent.session_id,this.form.delay,this.form.jitter)}catch(t){this.$snack.error(`Update agent delay failed: ${t}`);return}this.$snack.info(`Tasked agent to change delay to: ${this.form.delay}`)}},async updateJitter(){if(this.agent.jitter!==this.form.jitter){try{await de(this.agent.session_id,this.form.delay,this.form.jitter)}catch(t){this.$snack.error(`Update agent delay failed: ${t}`);return}this.$snack.info(`Tasked agent to change jitter to: ${this.form.jitter}`)}},fieldExists(t){return this.fields.filter(e=>e.name===t).length>0}}};var ui=function(){var e=this,i=e._self._c;return i("div",{staticStyle:{padding:"10px"}},[e.agent.session_id?i(R,{ref:"form",model:{value:e.valid,callback:function(s){e.valid=s},expression:"valid"}},[i(c,{attrs:{label:"Session ID",editable:!1,value:e.form.session_id}}),i(c,{attrs:{label:"Name",rules:e.nameRules,editable:!e.readOnly},on:{update:e.updateName},model:{value:e.form.name,callback:function(s){e.$set(e.form,"name",s)},expression:"form.name"}}),i(c,{attrs:{label:"External IP",value:e.form.external_ip,editable:!1}}),i(c,{attrs:{label:"Internal IP",value:e.form.internal_ip,editable:!1}}),i(c,{attrs:{label:"Host Name",value:e.form.hostname,editable:!1}}),i(c,{attrs:{label:"Username",value:e.form.username,editable:!1}}),i(c,{attrs:{label:"Listener","data-type":"string","suggested-values":e.listeners.map(s=>s.name),strict:!0,editable:!e.readOnly},on:{update:e.updateListener},model:{value:e.form.listener,callback:function(s){e.$set(e.form,"listener",s)},expression:"form.listener"}}),i(c,{attrs:{label:"Kill Date","data-type":"date",editable:!e.readOnly},on:{update:e.updateKillDate},model:{value:e.form.kill_date,callback:function(s){e.$set(e.form,"kill_date",s)},expression:"form.kill_date"}}),i(c,{attrs:{label:"Working Hours",rules:e.workingHoursRules,editable:!e.readOnly},on:{update:e.updateWorkingHours},model:{value:e.form.working_hours,callback:function(s){e.$set(e.form,"working_hours",s)},expression:"form.working_hours"}}),i(c,{attrs:{label:"Check In Time",value:e.moment(e.form.checkin_time).fromNow(),editable:!1}}),i(c,{attrs:{label:"Last Seen Time",value:e.moment(e.form.lastseen_time).fromNow(),editable:!1}}),i(c,{attrs:{label:"Delay","data-type":"number",rules:e.delayRules,editable:!e.readOnly},on:{update:e.updateDelay},model:{value:e.form.delay,callback:function(s){e.$set(e.form,"delay",s)},expression:"form.delay"}}),i(c,{attrs:{label:"Jitter","data-type":"number",rules:e.jitterRules,editable:!e.readOnly},on:{update:e.updateJitter},model:{value:e.form.jitter,callback:function(s){e.$set(e.form,"jitter",s)},expression:"form.jitter"}}),i(c,{attrs:{label:"Lost Limit","data-type":"number",editable:!1},model:{value:e.form.lost_limit,callback:function(s){e.$set(e.form,"lost_limit",s)},expression:"form.lost_limit"}}),i(c,{attrs:{label:"OS Details",value:e.form.os_details,editable:!1}}),i(c,{attrs:{label:"Architecture",value:e.form.architecture,editable:!1}}),i(c,{attrs:{label:"Process ID",value:e.form.process_id,editable:!1}}),i(c,{attrs:{label:"Process Name",value:e.form.process_name,editable:!1}}),i(c,{attrs:{label:"Language",value:e.form.language,editable:!1}}),i(c,{attrs:{label:"Language Version",value:e.form.language_version,editable:!1}}),i(c,{attrs:{label:"Profile",value:e.form.profile,editable:!1}})],1):e._e()],1)},ci=[],pi=k(di,ui,ci,!1,null,"94fe5ddd",null,null);const Me=pi.exports;const mi={name:"AgentCommandHistory",components:{TooltipButton:S},mixins:[$t],props:{agent:{type:Object,required:!0},refreshTasks:{type:Boolean,default:!1}},data(){return{tasks:[],currentPage:1,totalPages:1,totalItems:0,itemsPerPage:10,search:"",loading:!1,moment:N,sortBy:"id",sortDesc:!0,refreshInterval:null,expandedTasks:{},debouncedHandleSearch:()=>{},headers:[{text:"Task ID",value:"id",sortable:!0},{text:"Status",value:"status",sortable:!0},{text:"Task Input",value:"input",sortable:!1},{text:"Task Name",value:"task_name",sortable:!1},{text:"User",value:"username",sortable:!1},{text:"Updated At",value:"updated_at",sortable:!0},{text:"Actions",value:"actions",sortable:!1}]}},watch:{refreshTasks(t){t?(this.getTasks(),this.refreshInterval=setInterval(()=>{this.getTasks()},8e3)):clearInterval(this.refreshInterval)},agent:{handler(){this.initialize()}}},async mounted(){this.agent&&this.initialize(),this.debouncedHandleSearch=we(this.handleSearch,500)},beforeDestroy(){clearInterval(this.refreshInterval)},methods:{initialize(){this.getTasks()},truncateMessage(t){return t?t.length>30?`${t.substr(0,30)}...`:t:""},isDownload(t){return t.downloads&&t.downloads.length>0},downloadFile(t){wt(t.id)},hasOutput(t){return!!t.output},async downloadInput(t){if(t.input){if(!this.expandedTasks[t.id]){const e=await M(this.agent.session_id,t.id);this.expandedTasks[t.id]=e}this.downloadText(this.expandedTasks[t.id].full_input,`${t.agent_id}-${t.id}-input.txt`)}},downloadOutput(t){t.output&&this.downloadText(t.output,`${t.agent_id}-${t.id}-output.txt`)},async copyInput(t){if(t.input){if(!this.expandedTasks[t.id]){const e=await M(this.agent.session_id,t.id);this.expandedTasks[t.id]=e}try{navigator.clipboard.writeText(this.expandedTasks[t.id].full_input)}catch{this.$snack.warn("Failed to copy to clipboard. You must be on HTTPS or localhost.")}}},copyOutput(t){if(t.output)try{navigator.clipboard.writeText(t.output)}catch{this.$snack.warn("Failed to copy to clipboard. You must be on HTTPS or localhost.")}},imageData(t,e){var s;const i=(s=this.expandedTasks[t.id])==null?void 0:s.downloads;if(i){const n=i.find(a=>a.id===e.id);if(n)return n.image}return null},async getImagesForTask(t){var e;if(!this.expandedTasks[t.id]){const i=await M(this.agent.session_id,t.id);this.expandedTasks[t.id]=i}for(let i=0;i<t.downloads.length;i++){const s=t.downloads[i];if(!((e=this.expandedTasks[t.id].downloads[s.id])!=null&&e.image)&&s.filename.match(/[^/]+(jpg|jpeg|png|gif)$/)){const n=await xt(s.id);this.expandedTasks[t.id].downloads[i].image=n}}P.set(this.tasks,this.tasks.indexOf(t),t)},async toggleSeeFullInput(t){if(this.expandedTasks[t.id])t.expandedInput=!t.expandedInput;else{const e=await M(this.agent.session_id,t.id);this.expandedTasks[t.id]=e,t.expandedInput=!0}P.set(this.tasks,this.tasks.indexOf(t),t)},async getTasks(){var e;if(!((e=this.agent)!=null&&e.session_id))return;this.loading=!0;const t=await _e(this.agent.session_id,{page:this.currentPage,limit:this.itemsPerPage,sortBy:this.sortBy,sortOrder:this.sortDesc?"desc":"asc",search:this.search});this.currentPage=t.page,this.totalPages=t.total_pages,this.totalItems=t.total,this.tasks=t.records.map(i=>(i.uniqueId=`${i.agent_id}-${i.id}`,this.expandedTasks[i.id]&&(i.expandedInput=!0),i)),this.tasks=t.records,this.loading=!1},handleSearch(){this.getTasks()},handlePageChange(t){this.currentPage=t,this.getTasks()},handleOptionsChange(t){this.currentPage=t.page,this.itemsPerPage=t.itemsPerPage,t.sortBy.length>0?(this.sortBy=t.sortBy[0],this.sortDesc=t.sortDesc[0]):(this.sortBy="id",this.sortDesc=!0),this.getTasks()}}};var fi=function(){var e=this,i=e._self._c;return i("div",[i("div",{staticStyle:{display:"flex","flix-direction":"row"}},[i(b,{staticClass:"mr-2 pa-2",staticStyle:{width:"300px"},attrs:{elevation:"2",outlined:""}},[i(Tt,{staticClass:"mb-6",attrs:{multiple:""}},[i(Dt,[i(Pt,{attrs:{"expand-icon":"mdi-menu-down"}},[e._v(" Search ")]),i(zt,[i(_,{attrs:{label:"Search",outlined:"",dense:"",required:""},on:{input:e.debouncedHandleSearch},model:{value:e.search,callback:function(s){e.search=s},expression:"search"}})],1)],1)],1)],1),i(b,{staticStyle:{"flex-grow":"1"},attrs:{elevation:"2",outlined:""}},[i(kt,{attrs:{length:e.totalPages,"total-visible":10},on:{input:e.handlePageChange},model:{value:e.currentPage,callback:function(s){e.currentPage=s},expression:"currentPage"}}),i(It,{attrs:{headers:e.headers,items:e.tasks,"item-key":"uniqueId","sort-by":e.sortBy,"sort-desc":e.sortDesc,"server-items-length":e.totalItems,"footer-props":{"items-per-page-options":[10,25,50,100]},"items-per-page":e.itemsPerPage,loading:e.loading,page:e.currentPage,"show-expand":""},on:{"update:itemsPerPage":function(s){e.itemsPerPage=s},"update:items-per-page":function(s){e.itemsPerPage=s},"update:options":e.handleOptionsChange},scopedSlots:e._u([{key:"expanded-item",fn:function({headers:s,item:n}){return[i("td",{attrs:{colspan:s.length}},[i("div",[i("div",{staticClass:"pt-2"},[i(S,{attrs:{icon:n.expandedInput?"fa-minus":"fa-plus",text:"See Full Input","x-small":""},on:{click:function(a){return e.toggleSeeFullInput(n)}}})],1),i("p",[i("b",[e._v("Task Input:")])]),i("p",{staticClass:"mono",staticStyle:{"max-width":"900px"}},[e._v(" "+e._s(n.expandedInput?e.expandedTasks[n.id].full_input:n.input)+" ")]),i("p",[i("b",[e._v("Task Output:")])]),n.downloads.length>0&&n.downloads.some(a=>a.filename.match(/[^/]+(jpg|jpeg|png|gif)$/))?i("div",[i(v,{attrs:{text:"","x-small":""},on:{click:function(a){return e.getImagesForTask(n)}}},[e._v(" View Images ")]),i("div",e._l(n.downloads,function(a){return i(ct,{key:a.id,attrs:{src:e.imageData(n,a),alt:a.filename,"max-width":700,contain:""}})}),1)],1):e._e(),i("p",{staticClass:"mono",staticStyle:{"max-width":"900px"}},[e._v(" "+e._s(n.output)+" ")])])])]}},{key:"item.status",fn:function({item:s}){return[s.status==="pulled"?i(p,{attrs:{color:"green",small:""}},[e._v(" fa-check-square ")]):s.status==="queued"?i(p,{attrs:{color:"orange",small:""}},[e._v(" fa-clock ")]):e._e()]}},{key:"item.input",fn:function({item:s}){return[i("span",[e._v(e._s(e.truncateMessage(s.input)))])]}},{key:"item.task_name",fn:function({item:s}){return[i("span",[e._v(e._s(s.module_name==null?s.task_name:s.module_name))])]}},{key:"item.updated_at",fn:function({item:s}){return[i(U,{attrs:{top:""},scopedSlots:e._u([{key:"activator",fn:function({on:n}){return[i("span",e._g({},n),[e._v(e._s(e.moment(s.updated_at).fromNow()))])]}}],null,!0)},[i("span",[e._v(e._s(e.moment(s.updated_at).format("MMM D YYYY, h:mm:ss a")))])])]}},{key:"item.actions",fn:function({item:s}){return[i(re,{attrs:{"offset-y":""},scopedSlots:e._u([{key:"activator",fn:function({on:n,attrs:a}){return[i(v,e._g(e._b({attrs:{text:"",icon:"","x-small":""}},"v-btn",a,!1),n),[i(p,[e._v("fa-ellipsis-v")])],1)]}}],null,!0)},[i(ye,{staticClass:"ml-2 mr-2"},[i(D,{key:"downloadInput",attrs:{link:""},on:{click:function(n){return e.downloadInput(s)}}},[i(A,[i(p,[e._v("fa-download")]),e._v(" Download Input ")],1)],1),e.hasOutput(s)?i(D,{key:"downloadOutput",attrs:{link:""},on:{click:function(n){return e.downloadOutput(s)}}},[i(A,[i(p,[e._v("fa-download")]),e._v(" Download Output ")],1)],1):e._e(),i(D,{key:"clipboardInput",attrs:{link:""},on:{click:function(n){return e.copyInput(s)}}},[i(A,[i(p,[e._v("fa-paperclip")]),e._v(" Copy Input to Clipboard ")],1)],1),e.hasOutput(s)?i(D,{key:"clipboardOutput",attrs:{link:""},on:{click:function(n){return e.copyOutput(s)}}},[i(A,[i(p,[e._v("fa-paperclip")]),e._v(" Copy Output to Clipboard ")],1)],1):e._e(),i(I),e._l(s.downloads,function(n){return i(D,{key:"download-"+n.id,attrs:{link:""},on:{click:function(a){return e.downloadFile(n)}}},[i(A,[i(p,[e._v("fa-download")]),e._v(" Download "+e._s(n.filename)+" ")],1)],1)})],2)],1)]}}])})],1)],1)])},gi=[],vi=k(mi,fi,gi,!1,null,null,null,null);const Fe=vi.exports,_i={components:{AgentExecuteModule:q},props:{value:Boolean,loading:{type:Boolean,default:!1},agent:{type:String,required:!0},moduleName:{type:String,required:!0},moduleOptionDefaults:{type:Object,default:()=>{}}},data(){return{}},computed:{show:{get(){return this.value},set(t){this.$emit("input",t)}}},methods:{async submit(){!this.$refs.executeform.validate()||(this.$refs.executeform.create(),this.show=!1)}}};var yi=function(){var e=this,i=e._self._c;return i(ie,{ref:"downloadDialog",attrs:{"max-width":"800px"},model:{value:e.show,callback:function(s){e.show=s},expression:"show"}},[i(b,[i(se,[i("span",{staticClass:"headline"})]),i(j,[e.show?i(q,{ref:"executeform",attrs:{agents:[e.agent],"module-name":e.moduleName,"module-option-defaults":e.moduleOptionDefaults,"show-submit":!1},on:{submitted:e.submit}}):e._e()],1),i(ne,[i(I),i(v,{attrs:{color:"error",text:""},on:{click:function(s){s.stopPropagation(),e.show=!1}}},[e._v(" Close ")]),i(v,{attrs:{color:"primary",loading:e.loading},on:{click:e.submit}},[e._v(" Submit ")])],1)],1)],1)},bi=[],ki=k(_i,yi,bi,!1,null,null,null,null);const Oe=ki.exports;async function ce(t=1e3){return new Promise(e=>setTimeout(e,t))}const $i={components:{ExecuteModuleDialog:Oe},props:{agent:{type:Object,required:!0},readOnly:{type:Boolean,default:!1}},data(){return{files:{html:"mdi-language-html5",js:"mdi-nodejs",json:"mdi-json",md:"mdi-markdown",pdf:"mdi-file-pdf",png:"mdi-file-image",txt:"mdi-file-document-outline",xls:"mdi-file-excel",xlsx:"mdi-file-excel",ppt:"mdi-file-powerpoint",pptx:"mdi-file-powerpoint",jpg:"mdi-file-image",jpeg:"mdi-file-image",gif:"mdi-file-image",doc:"mdi-file-word",docx:"mdi-file-word"},tree:[],open:[],showMenu:!1,menuPosition:{x:0,y:0},selected:{},force:{},currentlyLoading:{},loading:!1,debouncedLoadChildren:null,executeDialog:!1,moduleName:"",moduleOptionDefaults:{}}},computed:{menuItems(){return[{id:"close",name:"Close",fileOption:!1,folderOption:!0},{id:"open",name:"Open",fileOption:!1,folderOption:!0},{id:"refresh",name:"Refresh",fileOption:!1,folderOption:!0},{id:"download",name:"Download to Empire",fileOption:!0,folderOption:!1},{id:"zip",name:"Zip Folder",fileOption:!1,folderOption:!0},{id:"upload",name:"Upload",folderOption:!0,fileOption:!1}].filter(t=>this.selected.file?t.fileOption===!0:t.folderOption===!0).filter(t=>!(t.id==="zip"&&this.agent.language!=="powershell")).filter(t=>{if(t.id==="open"){if(this.open.find(e=>e===this.selected.id))return!1}else if((t.id==="close"||t.id==="refresh")&&!this.open.find(e=>e===this.selected.id))return!1;return!0})}},watch:{agent:{handler(){this.initialize()}}},async mounted(){this.agent&&this.initialize()},methods:{async initialize(){this.debouncedLoadChildren=we(this.loadChildren,500,{leading:!0}),this.loading=!0;try{const t=await K(this.agent.session_id,"/");t.sort(this.sortFiles),this.tree=t.map(e=>this.transform(e))}catch{if(this.readOnly){this.loading=!1;return}const e=await this.scrapeDirectory("/");let i=0,s=0;for(;i<10;){if(await ce(6e3),await this.checkTaskComplete(e.id)){s=!0;break}i++}s||this.$snack.error("Agent didn't respond in time. Please try again later.");const n=await K(this.agent.session_id,"/");n.sort(this.sortFiles),this.tree=n.map(a=>this.transform(a))}this.loading=!1},async clickAction(t){if(t==="open")this.open.push(this.selected.id);else if(t==="close")this.open.splice(this.open.findIndex(e=>e===this.selected.id),1);else if(t==="refresh"){this.selected.children=[];const e=this.$refs.treeview.nodes[this.selected.id];this.open.splice(this.open.findIndex(i=>i===this.selected.id),1),await P.nextTick(),e.vnode.hasLoaded=!1,this.force[this.selected.id]=!0,await P.nextTick(),this.open.push(this.selected.id)}else t==="download"?(be(this.agent.session_id,this.selected.path),this.$snack.success(`Tasked ${this.agent.session_id} for download ${this.selected.path}`)):t==="zip"?this.prepareZip():t==="upload"&&this.$emit("openUploadDialog",{pathToFile:this.selected.path})},prepareZip(){const t={agent:this.agent.session_id,Folder:this.selected.path,ZipFileName:`${this.selected.path}\\${this.selected.path.split("\\").pop()}.zip`};this.moduleName="powershell/management/zipfolder",this.moduleOptionDefaults=t,this.executeDialog=!0},show(t,e){e.preventDefault(),this.showMenu=!1,this.menuPosition.x=e.clientX,this.menuPosition.y=e.clientY,this.selected=t,this.$nextTick(()=>{this.showMenu=!0})},transform(t){return{file:t.is_file===!0?t.name.split(".").pop():!1,...t,children:t.is_file===!1?[]:void 0}},async loadChildren(t,{stopTrying:e}={}){if(this.currentlyLoading[t.id])return Promise.resolve();this.currentlyLoading[t.id]=!0;const i=await K(this.agent.session_id,t.id);if(i.sort(this.sortFiles),!this.force[t.id]&&i.length>0)return this.removeFromCurrentlyLoading(t.id),t.children=i.map(s=>this.transform(s)),Promise.resolve();if(!e&&!this.readOnly){console.log(e,this.readOnly),this.$snack.success(`Attempting to retrieve directory: ${t.path} with id ${t.id}`);const s=await this.scrapeDirectory(t.path);let n=0,a=!1;for(;n<10;){if(await ce(6e3),await this.checkTaskComplete(s.id)){console.log("task complete",s.id),a=!0;break}n++}return a||this.$snack.error("Agent didn't respond in time. Please try again later."),this.removeFromForce(t.id),this.removeFromCurrentlyLoading(t.id),Promise.resolve(this.loadChildren(t,{stopTrying:!0}))}return this.removeFromForce(t.id),this.removeFromCurrentlyLoading(t.id),Promise.resolve()},removeFromForce(t){this.force[t]&&delete this.force[t]},removeFromCurrentlyLoading(t){this.currentlyLoading[t]&&delete this.currentlyLoading[t]},async scrapeDirectory(t){return pt(this.agent.session_id,t)},async checkTaskComplete(t){try{return!!(await M(this.agent.session_id,t)).output}catch{return!1}},sortFiles(t,e){const i=t.name.toLowerCase(),s=e.name.toLowerCase();return i<s?-1:i>s?1:0}}};var wi=function(){var e=this,i=e._self._c;return e.agent.language==="ironpython"?i("div",[i(xe,{attrs:{prominent:"",type:"error"}},[i(O,{attrs:{align:"center"}},[i(T,{staticClass:"grow"},[e._v(" The File Browser is not yet implemented for this agent language. ")])],1)],1)],1):i("div",[i(Oe,{attrs:{agent:e.agent.session_id,"module-name":e.moduleName,"module-option-defaults":e.moduleOptionDefaults},model:{value:e.executeDialog,callback:function(s){e.executeDialog=s},expression:"executeDialog"}}),e.loading?i(p,{staticClass:"fa-3x fas fa-spinner fa-spin",staticStyle:{width:"50px"}}):e._e(),i(ai,{ref:"treeview",attrs:{dense:"",hoverable:"","open-on-click":"","item-key":"id","load-children":e.debouncedLoadChildren,open:e.open,items:e.tree},on:{"update:open":function(s){e.open=s}},scopedSlots:e._u([{key:"label",fn:function({item:s,open:n}){return[i(v,{staticClass:"text-left",staticStyle:{"margin-left":"-15px",width:"100%"},attrs:{text:""},on:{contextmenu:function(a){return e.show(s,a)}}},[i("div",{staticStyle:{display:"flex","justify-content":"fle -start"}},[s.file?i(p,[e._v(" "+e._s(e.files[s.file]||"mdi-file")+" ")]):i(p,[e._v(" "+e._s(n?"mdi-folder-open":"mdi-folder")+" ")]),i("span",{staticClass:"ml-2"},[e._v(e._s(s.name))])],1)])]}}])}),i(re,{attrs:{"position-x":e.menuPosition.x,"position-y":e.menuPosition.y,"close-on-content-click":"",absolute:"","offset-y":""},model:{value:e.showMenu,callback:function(s){e.showMenu=s},expression:"showMenu"}},[i(ye,e._l(e.menuItems,function(s){return i(D,{key:s.id,on:{click:function(n){return e.clickAction(s.id)}}},[i(mt,[e._v(e._s(s.name))])],1)}),1)],1)],1)},xi=[],Si=k($i,wi,xi,!1,null,null,null,null);const Be=Si.exports;const Ci={props:{agent:{type:Object,required:!0}},data(){return{loading:!1,form:{command:"",literal:!1},commands:[],tooltipText:"This will ensure that aliased commands such as whoami or ps do not execute the built-in agent aliases."}},methods:{async submit(){this.form.command.length<1||(this.loading=!0,this.form.command.trim()==="sysinfo"?await ft(this.agent.session_id):await gt(this.agent.session_id,this.form.command,this.form.literal),this.form.command="",this.loading=!1,this.$snack.success(`Shell Command queued for ${this.agent.name}`))}}};var Ti=function(){var e=this,i=e._self._c;return i("div",{staticStyle:{padding:"10px"}},[i(R,{ref:"form",staticClass:"form",nativeOn:{submit:function(s){return s.preventDefault(),e.submit.apply(null,arguments)}}},[i(ae,[i(O,[i(T,{attrs:{cols:"8"}},[i("div",{staticStyle:{display:"flex"}},[i(vt,{staticClass:"pr-2",attrs:{label:"Literal"},model:{value:e.form.literal,callback:function(s){e.$set(e.form,"literal",s)},expression:"form.literal"}}),i(U,{attrs:{bottom:""},scopedSlots:e._u([{key:"activator",fn:function({on:s}){return[i(p,e._g({staticClass:"pr-2",attrs:{small:""}},s),[e._v(" fa-question-circle ")])]}}])},[i("p",[e._v(e._s(e.tooltipText))])]),i(_,{attrs:{dense:"",outlined:"",label:"Shell Command"},model:{value:e.form.command,callback:function(s){e.$set(e.form,"command",s)},expression:"form.command"}})],1)]),i(T,{attrs:{cols:"4",md:"4"}},[i(v,{attrs:{color:"primary",loading:e.loading,type:"submit"}},[e._v(" Run ")])],1)],1)],1)],1)],1)},Di=[],Pi=k(Ci,Ti,Di,!1,null,"bac1b187",null,null);const Ee=Pi.exports;const zi={name:"TooltipButtonToggle",props:{value:{type:Boolean,default:!1},icon:{type:String,required:!0},buttonText:{type:String,default:""},text:{type:String,required:!0}},data(){return{internalValue:!1}},watch:{value:{immediate:!0,handler(t){this.internalValue=t}},internalValue:{handler(t){this.$emit("input",t)}}}};var Ii=function(){var e=this,i=e._self._c;return i(U,{attrs:{bottom:""},scopedSlots:e._u([{key:"activator",fn:function({on:s}){return[i(Ot,{staticClass:"mr-5",model:{value:e.internalValue,callback:function(n){e.internalValue=n},expression:"internalValue"}},[i(v,e._g({attrs:{value:!0}},s),[i(p,{attrs:{left:""}},[e._v(" "+e._s(e.icon)+" ")]),i("span",[e._v(e._s(e.buttonText))])],1)],1)]}}])},[i("span",[e._v(e._s(e.text))])])},Ai=[],Mi=k(zi,Ii,Ai,!1,null,null,null,null);const Ve=Mi.exports,Fi={props:{value:Boolean,loading:{type:Boolean,default:!1}},data(){return{pathToFile:"",rules:{pathToFile:[t=>!!t||"PathToFile is required"]}}},computed:{show:{get(){return this.value},set(t){this.$emit("input",t)}}},watch:{value(t){t===!1&&this.$refs.form.reset()}},methods:{async submit(){!this.$refs.form.validate()||this.$emit("submit",{pathToFile:this.pathToFile})}}};var Oi=function(){var e=this,i=e._self._c;return i(ie,{ref:"downloadDialog",attrs:{"max-width":"500px"},model:{value:e.show,callback:function(s){e.show=s},expression:"show"}},[i(b,[i(se,[i("span",{staticClass:"headline"},[e._v("Download")])]),i(j,[i(R,{ref:"form",on:{submit:function(s){s.preventDefault()}}},[i(ae,[i(O,[i(T,{attrs:{cols:"12"}},[i(_,{attrs:{label:"path/to/file",rules:e.rules.pathToFile,outlined:"",dense:"",required:""},model:{value:e.pathToFile,callback:function(s){e.pathToFile=s},expression:"pathToFile"}})],1)],1)],1)],1)],1),i(ne,[i(I),i(v,{attrs:{color:"blue darken-1",text:""},on:{click:function(s){s.stopPropagation(),e.show=!1}}},[e._v(" Close ")]),i(v,{attrs:{color:"blue darken-1",text:"",loading:e.loading},on:{click:e.submit}},[e._v(" Save ")])],1)],1)],1)},Bi=[],Ei=k(Fi,Oi,Bi,!1,null,null,null,null);const Le=Ei.exports,V=1048576,Vi={props:{value:Boolean,language:{type:String,default:""},loading:{type:Boolean,default:!1},pathToFile:{type:String,default:""}},data(){return{uploadType:"uploadnew",isLoading:!1,descriptionLimit:80,selectedDownload:{},search:null,entries:[],internalPathToFile:this.pathToFile,file:null,rules:{pathToFile:[t=>!!t||"PathToFile is required"],fileInput:[t=>!!t||"File required",t=>!!t&&t.size<V||`Maximum size of ${Math.floor(V/1e6)} MiB.`],selectedDownload:[t=>!!t||"File required",t=>!!t&&t.size<V||`Maximum size of ${Math.floor(V/1e6)} MiB.`]}}},computed:{show:{get(){return this.value},set(t){this.$emit("input",t)}},fileName(){return this.file?this.file.name:""},items(){return this.entries.map(t=>{const e=t.location.length>this.descriptionLimit?`(${this.formatBytes(t.size)}) ${t.location.slice(0,this.descriptionLimit)}...`:`(${this.formatBytes(t.size)}) ${t.location}`;return{...t,description:e}})}},watch:{pathToFile(t){this.internalPathToFile=t},value(t){t===!1&&this.$refs.form.reset()},file(t){t&&(this.language==="python"?!this.internalPathToFile||this.internalPathToFile.length===0?this.internalPathToFile=`/tmp/${t.name}`:this.internalPathToFile.endsWith("/")?this.internalPathToFile+=t.name:this.internalPathToFile=`/tmp/${t.name}`:this.language==="powershell"&&(!this.internalPathToFile||this.internalPathToFile.length===0?this.internalPathToFile=`C:\\tmp\\${t.name}`:this.internalPathToFile.endsWith("/")||this.internalPathToFile.endsWith("\\")?this.internalPathToFile+=t.name:this.internalPathToFile=`C:\\tmp\\${t.name}`))},selectedDownload(t){if(t){const{filename:e}=t;this.language==="python"?!this.internalPathToFile||this.internalPathToFile.length===0?this.internalPathToFile=`/tmp/${e}`:this.internalPathToFile.endsWith("/")?this.internalPathToFile+=e:this.internalPathToFile=`/tmp/${e}`:this.language==="powershell"&&(!this.internalPathToFile||this.internalPathToFile.length===0?this.internalPathToFile=`C:\\tmp\\${e}`:this.internalPathToFile.endsWith("/")||this.internalPathToFile.endsWith("\\")?this.internalPathToFile+=e:this.internalPathToFile=`C:\\tmp\\${e}`)}},search(){this.items.length>0||this.isLoading||(this.isLoading=!0,St({page:1,limit:-1}).then(t=>{const{total:e,records:i}=t;this.count=e,this.entries=i}).catch(t=>{console.log(t)}).finally(()=>{this.isLoading=!1}))}},methods:{async submit(){if(!this.$refs.form.validate())return;let t=null;if(this.uploadType==="uploadnew"){const e=new FormData;e.append("file",this.file),t=(await Ct(e)).data.id}else t=this.selectedDownload.id;this.$emit("submit",{file:t,pathToFile:this.internalPathToFile})},formatBytes(t,e){if(t===0)return"0 Bytes";const i=1024,s=e||2,n=["Bytes","KB","MB","GB","TB","PB","EB","ZB","YB"],a=Math.floor(Math.log(t)/Math.log(i));return`${parseFloat((t/i**a).toFixed(s))} ${n[a]}`}}};var Li=function(){var e=this,i=e._self._c;return i(ie,{ref:"uploadDialog",attrs:{"max-width":"750px"},model:{value:e.show,callback:function(s){e.show=s},expression:"show"}},[i(b,[i(se,[i("span",{staticClass:"headline"},[e._v("Upload")])]),i(j,[i(R,{ref:"form",attrs:{"on-submit":"return false;"},on:{submit:function(s){s.preventDefault()}}},[i(ae,[i(O,[i(T,{attrs:{cols:"12"}},[i(ei,{attrs:{mandatory:"",row:""},model:{value:e.uploadType,callback:function(s){e.uploadType=s},expression:"uploadType"}},[i(ue,{attrs:{value:"uploadnew",label:"Upload New File"}}),i(ue,{attrs:{value:"useexisting",label:"Use Existing File"}})],1),e.uploadType==="uploadnew"?i(Xt,{ref:"fileInput",attrs:{accept:"*/*",rules:e.rules.fileInput},model:{value:e.file,callback:function(s){e.file=s},expression:"file"}}):i(ke,{attrs:{items:e.items,loading:e.isLoading,"search-input":e.search,rules:e.rules.selectedDownload,"hide-no-data":"","hide-selected":"","cache-items":"","item-text":"description","item-value":"filename",label:"Server Files",placeholder:"Start typing to Search","prepend-icon":"mdi-database-search","return-object":"",outlined:"",dense:""},on:{"update:searchInput":function(s){e.search=s},"update:search-input":function(s){e.search=s}},model:{value:e.selectedDownload,callback:function(s){e.selectedDownload=s},expression:"selectedDownload"}}),i(_,{attrs:{label:"path/to/file (On the agent's machine)",rules:e.rules.pathToFile,outlined:"",dense:"",required:""},model:{value:e.internalPathToFile,callback:function(s){e.internalPathToFile=s},expression:"internalPathToFile"}})],1)],1)],1)],1)],1),i(ne,[i(I),i(v,{attrs:{color:"blue darken-1",text:""},on:{click:function(s){s.stopPropagation(),e.show=!1}}},[e._v(" Close ")]),i(v,{attrs:{color:"blue darken-1",text:"",loading:e.loading},on:{click:e.submit}},[e._v(" Save ")])],1)],1)],1)},Ni=[],Yi=k(Vi,Li,Ni,!1,null,null,null,null);const Ne=Yi.exports;var Ri=Object.defineProperty,ji=Object.defineProperties,Ui=Object.getOwnPropertyDescriptors,Y=Object.getOwnPropertySymbols,Ye=Object.prototype.hasOwnProperty,Re=Object.prototype.propertyIsEnumerable,pe=(t,e,i)=>e in t?Ri(t,e,{enumerable:!0,configurable:!0,writable:!0,value:i}):t[e]=i,qi=(t,e)=>{for(var i in e||(e={}))Ye.call(e,i)&&pe(t,i,e[i]);if(Y)for(var i of Y(e))Re.call(e,i)&&pe(t,i,e[i]);return t},Wi=(t,e)=>ji(t,Ui(e)),Hi=(t,e)=>{var i={};for(var s in t)Ye.call(t,s)&&e.indexOf(s)<0&&(i[s]=t[s]);if(t!=null&&Y)for(var s of Y(t))e.indexOf(s)<0&&Re.call(t,s)&&(i[s]=t[s]);return i};function je(t,e,i,s,n,a,r,l){var o=typeof t=="function"?t.options:t;e&&(o.render=e,o.staticRenderFns=i,o._compiled=!0),s&&(o.functional=!0),a&&(o._scopeId="data-v-"+a);var u;if(r?(u=function($){$=$||this.$vnode&&this.$vnode.ssrContext||this.parent&&this.parent.$vnode&&this.parent.$vnode.ssrContext,!$&&typeof __VUE_SSR_CONTEXT__<"u"&&($=__VUE_SSR_CONTEXT__),n&&n.call(this,$),$&&$._registeredComponents&&$._registeredComponents.add(r)},o._ssrRegister=u):n&&(u=l?function(){n.call(this,(o.functional?this.parent:this).$root.$options.shadowRoot)}:n),u)if(o.functional){o._injectStyles=u;var y=o.render;o.render=function(Ue,oe){return u.call(oe),y(Ue,oe)}}else{var g=o.beforeCreate;o.beforeCreate=g?[].concat(g,u):[u]}return{exports:t,options:o}}const Ki={name:"splitpanes",props:{horizontal:{type:Boolean},pushOtherPanes:{type:Boolean,default:!0},dblClickSplitter:{type:Boolean,default:!0},rtl:{type:Boolean,default:!1},firstSplitter:{type:Boolean}},provide(){return{requestUpdate:this.requestUpdate,onPaneAdd:this.onPaneAdd,onPaneRemove:this.onPaneRemove,onPaneClick:this.onPaneClick}},data:()=>({container:null,ready:!1,panes:[],touch:{mouseDown:!1,dragging:!1,activeSplitter:null},splitterTaps:{splitter:null,timeoutId:null}}),computed:{panesCount(){return this.panes.length},indexedPanes(){return this.panes.reduce((t,e)=>(t[e.id]=e)&&t,{})}},methods:{updatePaneComponents(){this.panes.forEach(t=>{t.update&&t.update({[this.horizontal?"height":"width"]:`${this.indexedPanes[t.id].size}%`})})},bindEvents(){document.addEventListener("mousemove",this.onMouseMove,{passive:!1}),document.addEventListener("mouseup",this.onMouseUp),"ontouchstart"in window&&(document.addEventListener("touchmove",this.onMouseMove,{passive:!1}),document.addEventListener("touchend",this.onMouseUp))},unbindEvents(){document.removeEventListener("mousemove",this.onMouseMove,{passive:!1}),document.removeEventListener("mouseup",this.onMouseUp),"ontouchstart"in window&&(document.removeEventListener("touchmove",this.onMouseMove,{passive:!1}),document.removeEventListener("touchend",this.onMouseUp))},onMouseDown(t,e){this.bindEvents(),this.touch.mouseDown=!0,this.touch.activeSplitter=e},onMouseMove(t){this.touch.mouseDown&&(t.preventDefault(),this.touch.dragging=!0,this.calculatePanesSize(this.getCurrentMouseDrag(t)),this.$emit("resize",this.panes.map(e=>({min:e.min,max:e.max,size:e.size}))))},onMouseUp(){this.touch.dragging&&this.$emit("resized",this.panes.map(t=>({min:t.min,max:t.max,size:t.size}))),this.touch.mouseDown=!1,setTimeout(()=>{this.touch.dragging=!1,this.unbindEvents()},100)},onSplitterClick(t,e){"ontouchstart"in window&&(t.preventDefault(),this.dblClickSplitter&&(this.splitterTaps.splitter===e?(clearTimeout(this.splitterTaps.timeoutId),this.splitterTaps.timeoutId=null,this.onSplitterDblClick(t,e),this.splitterTaps.splitter=null):(this.splitterTaps.splitter=e,this.splitterTaps.timeoutId=setTimeout(()=>{this.splitterTaps.splitter=null},500)))),this.touch.dragging||this.$emit("splitter-click",this.panes[e])},onSplitterDblClick(t,e){let i=0;this.panes=this.panes.map((s,n)=>(s.size=n===e?s.max:s.min,n!==e&&(i+=s.min),s)),this.panes[e].size-=i,this.$emit("pane-maximize",this.panes[e])},onPaneClick(t,e){this.$emit("pane-click",this.indexedPanes[e])},getCurrentMouseDrag(t){const e=this.container.getBoundingClientRect(),{clientX:i,clientY:s}="ontouchstart"in window&&t.touches?t.touches[0]:t;return{x:i-e.left,y:s-e.top}},getCurrentDragPercentage(t){t=t[this.horizontal?"y":"x"];const e=this.container[this.horizontal?"clientHeight":"clientWidth"];return this.rtl&&!this.horizontal&&(t=e-t),t*100/e},calculatePanesSize(t){const e=this.touch.activeSplitter;let i={prevPanesSize:this.sumPrevPanesSize(e),nextPanesSize:this.sumNextPanesSize(e),prevReachedMinPanes:0,nextReachedMinPanes:0};const s=0+(this.pushOtherPanes?0:i.prevPanesSize),n=100-(this.pushOtherPanes?0:i.nextPanesSize),a=Math.max(Math.min(this.getCurrentDragPercentage(t),n),s);let r=[e,e+1],l=this.panes[r[0]]||null,o=this.panes[r[1]]||null;const u=l.max<100&&a>=l.max+i.prevPanesSize,y=o.max<100&&a<=100-(o.max+this.sumNextPanesSize(e+1));if(u||y){u?(l.size=l.max,o.size=Math.max(100-l.max-i.prevPanesSize-i.nextPanesSize,0)):(l.size=Math.max(100-o.max-i.prevPanesSize-this.sumNextPanesSize(e+1),0),o.size=o.max);return}if(this.pushOtherPanes){const g=this.doPushOtherPanes(i,a);if(!g)return;({sums:i,panesToResize:r}=g),l=this.panes[r[0]]||null,o=this.panes[r[1]]||null}l!==null&&(l.size=Math.min(Math.max(a-i.prevPanesSize-i.prevReachedMinPanes,l.min),l.max)),o!==null&&(o.size=Math.min(Math.max(100-a-i.nextPanesSize-i.nextReachedMinPanes,o.min),o.max))},doPushOtherPanes(t,e){const i=this.touch.activeSplitter,s=[i,i+1];return e<t.prevPanesSize+this.panes[s[0]].min&&(s[0]=this.findPrevExpandedPane(i).index,t.prevReachedMinPanes=0,s[0]<i&&this.panes.forEach((n,a)=>{a>s[0]&&a<=i&&(n.size=n.min,t.prevReachedMinPanes+=n.min)}),t.prevPanesSize=this.sumPrevPanesSize(s[0]),s[0]===void 0)?(t.prevReachedMinPanes=0,this.panes[0].size=this.panes[0].min,this.panes.forEach((n,a)=>{a>0&&a<=i&&(n.size=n.min,t.prevReachedMinPanes+=n.min)}),this.panes[s[1]].size=100-t.prevReachedMinPanes-this.panes[0].min-t.prevPanesSize-t.nextPanesSize,null):e>100-t.nextPanesSize-this.panes[s[1]].min&&(s[1]=this.findNextExpandedPane(i).index,t.nextReachedMinPanes=0,s[1]>i+1&&this.panes.forEach((n,a)=>{a>i&&a<s[1]&&(n.size=n.min,t.nextReachedMinPanes+=n.min)}),t.nextPanesSize=this.sumNextPanesSize(s[1]-1),s[1]===void 0)?(t.nextReachedMinPanes=0,this.panes[this.panesCount-1].size=this.panes[this.panesCount-1].min,this.panes.forEach((n,a)=>{a<this.panesCount-1&&a>=i+1&&(n.size=n.min,t.nextReachedMinPanes+=n.min)}),this.panes[s[0]].size=100-t.prevPanesSize-t.nextReachedMinPanes-this.panes[this.panesCount-1].min-t.nextPanesSize,null):{sums:t,panesToResize:s}},sumPrevPanesSize(t){return this.panes.reduce((e,i,s)=>e+(s<t?i.size:0),0)},sumNextPanesSize(t){return this.panes.reduce((e,i,s)=>e+(s>t+1?i.size:0),0)},findPrevExpandedPane(t){return[...this.panes].reverse().find(i=>i.index<t&&i.size>i.min)||{}},findNextExpandedPane(t){return this.panes.find(i=>i.index>t+1&&i.size>i.min)||{}},checkSplitpanesNodes(){Array.from(this.container.children).forEach(e=>{const i=e.classList.contains("splitpanes__pane"),s=e.classList.contains("splitpanes__splitter");if(!i&&!s){e.parentNode.removeChild(e),console.warn("Splitpanes: Only <pane> elements are allowed at the root of <splitpanes>. One of your DOM nodes was removed.");return}})},addSplitter(t,e,i=!1){const s=t-1,n=document.createElement("div");n.classList.add("splitpanes__splitter"),i||(n.onmousedown=a=>this.onMouseDown(a,s),typeof window<"u"&&"ontouchstart"in window&&(n.ontouchstart=a=>this.onMouseDown(a,s)),n.onclick=a=>this.onSplitterClick(a,s+1)),this.dblClickSplitter&&(n.ondblclick=a=>this.onSplitterDblClick(a,s+1)),e.parentNode.insertBefore(n,e)},removeSplitter(t){t.onmousedown=void 0,t.onclick=void 0,t.ondblclick=void 0,t.parentNode.removeChild(t)},redoSplitters(){const t=Array.from(this.container.children);t.forEach(i=>{i.className.includes("splitpanes__splitter")&&this.removeSplitter(i)});let e=0;t.forEach(i=>{i.className.includes("splitpanes__pane")&&(!e&&this.firstSplitter?this.addSplitter(e,i,!0):e&&this.addSplitter(e,i),e++)})},requestUpdate(t){var e=t,{target:i}=e,s=Hi(e,["target"]);const n=this.indexedPanes[i._uid];Object.entries(s).forEach(([a,r])=>n[a]=r)},onPaneAdd(t){let e=-1;Array.from(t.$el.parentNode.children).some(n=>(n.className.includes("splitpanes__pane")&&e++,n===t.$el));const i=parseFloat(t.minSize),s=parseFloat(t.maxSize);this.panes.splice(e,0,{id:t._uid,index:e,min:isNaN(i)?0:i,max:isNaN(s)?100:s,size:t.size===null?null:parseFloat(t.size),givenSize:t.size,update:t.update}),this.panes.forEach((n,a)=>n.index=a),this.ready&&this.$nextTick(()=>{this.redoSplitters(),this.resetPaneSizes({addedPane:this.panes[e]}),this.$emit("pane-add",{index:e,panes:this.panes.map(n=>({min:n.min,max:n.max,size:n.size}))})})},onPaneRemove(t){const e=this.panes.findIndex(s=>s.id===t._uid),i=this.panes.splice(e,1)[0];this.panes.forEach((s,n)=>s.index=n),this.$nextTick(()=>{this.redoSplitters(),this.resetPaneSizes({removedPane:Wi(qi({},i),{index:e})}),this.$emit("pane-remove",{removed:i,panes:this.panes.map(s=>({min:s.min,max:s.max,size:s.size}))})})},resetPaneSizes(t={}){!t.addedPane&&!t.removedPane?this.initialPanesSizing():this.panes.some(e=>e.givenSize!==null||e.min||e.max<100)?this.equalizeAfterAddOrRemove(t):this.equalize(),this.ready&&this.$emit("resized",this.panes.map(e=>({min:e.min,max:e.max,size:e.size})))},equalize(){const t=100/this.panesCount;let e=0,i=[],s=[];this.panes.forEach(n=>{n.size=Math.max(Math.min(t,n.max),n.min),e-=n.size,n.size>=n.max&&i.push(n.id),n.size<=n.min&&s.push(n.id)}),e>.1&&this.readjustSizes(e,i,s)},initialPanesSizing(){100/this.panesCount;let t=100,e=[],i=[],s=0;this.panes.forEach(a=>{t-=a.size,a.size!==null&&s++,a.size>=a.max&&e.push(a.id),a.size<=a.min&&i.push(a.id)});let n=100;t>.1&&(this.panes.forEach(a=>{a.size===null&&(a.size=Math.max(Math.min(t/(this.panesCount-s),a.max),a.min)),n-=a.size}),n>.1&&this.readjustSizes(t,e,i))},equalizeAfterAddOrRemove({addedPane:t,removedPane:e}={}){let i=100/this.panesCount,s=0,n=[],a=[];t&&t.givenSize!==null&&(i=(100-t.givenSize)/(this.panesCount-1)),this.panes.forEach(r=>{s-=r.size,r.size>=r.max&&n.push(r.id),r.size<=r.min&&a.push(r.id)}),!(Math.abs(s)<.1)&&(this.panes.forEach(r=>{t&&t.givenSize!==null&&t.id===r.id||(r.size=Math.max(Math.min(i,r.max),r.min)),s-=r.size,r.size>=r.max&&n.push(r.id),r.size<=r.min&&a.push(r.id)}),s>.1&&this.readjustSizes(s,n,a))},readjustSizes(t,e,i){let s;t>0?s=t/(this.panesCount-e.length):s=t/(this.panesCount-i.length),this.panes.forEach((n,a)=>{if(t>0&&!e.includes(n.id)){const r=Math.max(Math.min(n.size+s,n.max),n.min),l=r-n.size;t-=l,n.size=r}else if(!i.includes(n.id)){const r=Math.max(Math.min(n.size+s,n.max),n.min),l=r-n.size;t-=l,n.size=r}n.update({[this.horizontal?"height":"width"]:`${this.indexedPanes[n.id].size}%`})}),Math.abs(t)>.1&&this.$nextTick(()=>{this.ready&&console.warn("Splitpanes: Could not resize panes correctly due to their constraints.")})}},watch:{panes:{deep:!0,immediate:!1,handler(){this.updatePaneComponents()}},horizontal(){this.updatePaneComponents()},firstSplitter(){this.redoSplitters()},dblClickSplitter(t){[...this.container.querySelectorAll(".splitpanes__splitter")].forEach((i,s)=>{i.ondblclick=t?n=>this.onSplitterDblClick(n,s):void 0})}},beforeDestroy(){this.ready=!1},mounted(){this.container=this.$refs.container,this.checkSplitpanesNodes(),this.redoSplitters(),this.resetPaneSizes(),this.$emit("ready"),this.ready=!0},render(t){return t("div",{ref:"container",class:["splitpanes",`splitpanes--${this.horizontal?"horizontal":"vertical"}`,{"splitpanes--dragging":this.touch.dragging}]},this.$slots.default)}};let Gi,Zi;const me={};var Ji=je(Ki,Gi,Zi,!1,Xi,null,null,null);function Xi(t){for(let e in me)this[e]=me[e]}var Qi=function(){return Ji.exports}(),es=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"splitpanes__pane",style:t.style,on:{click:function(s){return t.onPaneClick(s,t._uid)}}},[t._t("default")],2)},ts=[];const is={name:"pane",inject:["requestUpdate","onPaneAdd","onPaneRemove","onPaneClick"],props:{size:{type:[Number,String],default:null},minSize:{type:[Number,String],default:0},maxSize:{type:[Number,String],default:100}},data:()=>({style:{}}),mounted(){this.onPaneAdd(this)},beforeDestroy(){this.onPaneRemove(this)},methods:{update(t){this.style=t}},computed:{sizeNumber(){return this.size||this.size===0?parseFloat(this.size):null},minSizeNumber(){return parseFloat(this.minSize)},maxSizeNumber(){return parseFloat(this.maxSize)}},watch:{sizeNumber(t){this.requestUpdate({target:this,size:t})},minSizeNumber(t){this.requestUpdate({target:this,min:t})},maxSizeNumber(t){this.requestUpdate({target:this,max:t})}}},fe={};var ss=je(is,es,ts,!1,ns,null,null,null);function ns(t){for(let e in fe)this[e]=fe[e]}var as=function(){return ss.exports}();const rs={name:"AgentEdit",components:{AgentForm:Me,AgentInteract:Ee,AgentExecuteModule:q,AgentFileBrowser:Be,AgentCommandHistory:Fe,AgentUploadDialog:Ne,AgentDownloadDialog:Le,TooltipButton:S,TooltipButtonToggle:Ve,ErrorStateAlert:Se,Splitpanes:Qi,Pane:as},data(){return{agent:{},nameLoading:!1,uploadLoading:!1,downloadLoading:!1,nameDialog:!1,uploadDialog:!1,downloadDialog:!1,interval:null,initialized:!0,errorState:!1,paneSize:100,rightPaneInitialized:!1,pathToFile:"",isRefreshTasks:!1}},computed:{breads(){return[{text:"Agents",disabled:this.isChild,to:"/agents",exact:!0},{text:this.breadcrumbName,disabled:!0,to:"/agent-edit"}]},archived(){return this.agent.archived},breadcrumbName(){return this.agent.name||this.id},id(){return this.$route.params.id},isChild(){return!!this.$route.query.hideSideBar},hideSideBar(){return this.$route.query.hideSideBar},tab:{set(t){this.$router.replace({query:{...this.$route.query,tab:t}})},get(){return this.$route.query.tab||"interact"}}},watch:{id(t){t&&this.getAgent(t)},paneSize(t){this.rightPaneInitialized||t<99&&(this.rightPaneInitialized=!0)}},mounted(){this.getAgent(this.$route.params.id)},methods:{toggleCollapsePane(){this.paneSize>95?this.paneSize=50:this.paneSize=100},splitPaneHeight(){return`height: calc(96vh - 104px ${this.isChild?"":"- 36px"})`},popout(){window.open(`${window.location.href}/?hideSideBar=true`,"popup","width=600,height=600"),this.$router.push({name:"agents"})},getAgent(t){_t(t).then(e=>{this.agent=e}).catch(()=>{this.errorState=!0})},async killAgent(){await this.$root.$confirm("Kill Agent",`Do you want to kill agent ${this.agent.name}?`,{color:"red"})&&(this.$store.dispatch("agent/killAgent",{sessionId:this.agent.session_id}),this.$snack.success(`Agent ${this.agent.name} tasked to run TASK_EXIT.`),this.$router.push({name:"agents"}))},async clearQueue(){const e=(await _e(this.agent.session_id,{limit:-1,page:1,status:"queued"})).records.map(i=>i.id);if(e.length===0){this.$snack.info("No queued tasks to clear.");return}await this.$root.$confirm("",`Do you want to clear ${e.length} queued tasks?`,{color:"red"})&&(this.$store.dispatch("agent/clearQueue",{name:this.agent.session_id,tasks:e}),this.$snack.success(`Clearing queued tasks for Agent ${this.agent.session_id}.`))},openUploadDialogPrefilled({pathToFile:t}){this.uploadDialog=!0,this.pathToFile=t},async doUpload({file:t,pathToFile:e}){if(!(this.uploadLoading||t==null||e==null||e.length<1)){this.uploadLoading=!0;try{await yt(this.agent.session_id,t,e),this.$snack.success(`Tasked agent ${this.agent.name} to upload file to ${e}`)}catch(i){this.$snack.error(`Error: ${i}`)}this.uploadLoading=!1,this.uploadDialog=!1}},async doDownload({pathToFile:t}){if(!(this.downloadLoading||t==null||t.length<1)){this.downloadLoading=!0;try{await be(this.agent.session_id,t),this.$snack.success(`Tasked agent ${this.agent.name} to downloaded file ${t}`)}catch(e){this.$snack.error(`Error: ${e}`)}this.downloadLoading=!1,this.downloadDialog=!1}},scrollResults(){}}};var ls=function(){var e=this,i=e._self._c;return i("div",[i("div",[i("portal",{attrs:{to:"app-bar-extension"}},[i("div",{staticStyle:{display:"flex","flex-direction":"row",width:"100%"}},[i(At,{attrs:{"align-with-title":""},model:{value:e.tab,callback:function(s){e.tab=s},expression:"tab"}},[i(B,{key:"interact",attrs:{href:"#interact"}},[e._v(" Interact ")]),i(B,{key:"file-browser",attrs:{href:"#file-browser"}},[e._v(" File Browser ")]),i(B,{key:"tasks",attrs:{href:"#tasks"}},[e._v(" Tasks ")]),i(B,{key:"view",attrs:{href:"#view"}},[e._v(" View ")])],1),i("div",{staticStyle:{display:"flex","flex-direction":"row"}},[e._e()],1)],1)]),i("portal",{attrs:{to:"app-bar"}},[i("div",{staticClass:"v-toolbar__content",staticStyle:{width:"100%"}},[i(Ft,{attrs:{items:e.breads}}),e.agent.high_integrity===1?i(U,{attrs:{bottom:""},scopedSlots:e._u([{key:"activator",fn:function({on:s}){return[i(p,e._g({attrs:{small:""}},s),[e._v(" fa-user-cog ")])]}}],null,!1,1636569802)},[i("span",[e._v("Elevated Process")])]):e._e(),e.initialized&&e.archived?i($e,[e._v(" Archived ")]):e._e(),i(I),e.errorState?e._e():i("div",{staticClass:"pt-2",staticStyle:{display:"flex","flex-direction":"row","align-items":"center"}},[i(Ne,{attrs:{language:e.agent.language,loading:e.uploadLoading,"path-to-file":e.pathToFile},on:{submit:e.doUpload},model:{value:e.uploadDialog,callback:function(s){e.uploadDialog=s},expression:"uploadDialog"}}),i(Le,{attrs:{loading:e.downloadLoading},on:{submit:e.doDownload},model:{value:e.downloadDialog,callback:function(s){e.downloadDialog=s},expression:"downloadDialog"}}),e.initialized&&!e.archived?i(Ve,{attrs:{icon:"fa-redo","button-text":e.isRefreshTasks?"On":"Off",text:"Auto-refresh tasks"},model:{value:e.isRefreshTasks,callback:function(s){e.isRefreshTasks=s},expression:"isRefreshTasks"}}):e._e(),e.initialized&&!e.archived?i(S,{attrs:{icon:"fa-calendar-times",text:"Clear Queued Tasks"},on:{click:e.clearQueue}}):e._e(),e.initialized&&!e.archived?i(S,{attrs:{icon:"fa-upload",text:"Upload"},on:{click:function(s){e.uploadDialog=!0}}}):e._e(),e.initialized&&!e.archived?i(S,{attrs:{icon:"fa-download",text:"Download"},on:{click:function(s){e.downloadDialog=!0}}}):e._e(),e.hideSideBar?e._e():i(S,{attrs:{icon:"fa-external-link-alt",text:"Popout"},on:{click:e.popout}}),e.initialized&&!e.archived?i(S,{attrs:{icon:"fa-trash-alt",text:"Kill Agent",color:"error"},on:{click:e.killAgent}}):e._e()],1)],1)]),e.errorState?i(Se,{attrs:{"resource-id":e.id,"resource-type":"agent"}}):e._e(),e.errorState?e._e():i("div",{style:e.splitPaneHeight()},[i("splitpanes",{attrs:{disabled:!0},on:{resize:function(s){e.paneSize=s[0].size}}},[i("pane",{attrs:{"min-size":"30",size:e.paneSize}},[i(Mt,{staticClass:"scrollable-pane",model:{value:e.tab,callback:function(s){e.tab=s},expression:"tab"}},[i(E,{key:"interact",attrs:{value:"interact",transition:!1,"reverse-transition":!1}},[e.initialized&&!e.archived?i(b,{attrs:{flat:""}},[i(Ee,{attrs:{agent:e.agent}}),i(bt),i("h4",{staticClass:"pl-4 pt-2"},[e._v(" Execute Module ")]),i(q,{attrs:{agents:[e.agent.session_id]}})],1):e.initialized&&e.archived?i(b,{attrs:{flat:""}},[i(j,[i(xe,{attrs:{type:"error",icon:"fa-exclamation-triangle",value:!0}},[e._v(" This agent is archived. ")])],1)],1):e._e()],1),i(E,{key:"browser",attrs:{value:"file-browser",transition:!1,"reverse-transition":!1}},[i(b,{attrs:{flat:""}},[i(Be,{attrs:{agent:e.agent,"read-only":e.initialized&&e.archived},on:{openUploadDialog:e.openUploadDialogPrefilled}})],1)],1),i(E,{key:"tasks",attrs:{value:"tasks",transition:!1,"reverse-transition":!1}},[i(b,{attrs:{flat:""}},[i(Fe,{attrs:{agent:e.agent,"refresh-tasks":e.isRefreshTasks}})],1)],1),i(E,{key:"view",attrs:{value:"view",transition:!1,"reverse-transition":!1}},[i(b,{attrs:{flat:""}},[i(Me,{attrs:{"read-only":e.initialized&&e.archived,agent:e.agent}})],1)],1)],1)],1)],1)],1)],1)])},os=[],hs=k(rs,ls,os,!1,null,null,null,null);const As=hs.exports;export{As as default};
