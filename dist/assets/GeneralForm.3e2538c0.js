import{G as g,z as l,a1 as p,D as I,v as c,n as f,a0 as y,V as _,ac as x,a6 as S,o as v,ad as b,l as V}from"./index.81c4d563.js";import{_ as D}from"./VSwitch.35d52e8f.js";import{V as i,d as C,c as o}from"./VSelect.0bed7eeb.js";import{_ as d,a as u}from"./VRow.2b8953c0.js";const m={...C,offsetY:!0,offsetOverflow:!0,transition:!1},r=i.extend({name:"v-autocomplete",props:{autoSelectFirst:{type:Boolean,default:!1},filter:{type:Function,default:(e,t,s)=>s.toLocaleLowerCase().indexOf(t.toLocaleLowerCase())>-1},hideNoData:Boolean,menuProps:{type:i.options.props.menuProps.type,default:()=>m},noFilter:Boolean,searchInput:{type:String}},data(){return{lazySearch:this.searchInput}},computed:{classes(){return{...i.options.computed.classes.call(this),"v-autocomplete":!0,"v-autocomplete--is-selecting-index":this.selectedIndex>-1}},computedItems(){return this.filteredItems},selectedValues(){return this.selectedItems.map(e=>this.getValue(e))},hasDisplayedItems(){return this.hideSelected?this.filteredItems.some(e=>!this.hasItem(e)):this.filteredItems.length>0},currentRange(){return this.selectedItem==null?0:String(this.getText(this.selectedItem)).length},filteredItems(){return!this.isSearching||this.noFilter||this.internalSearch==null?this.allItems:this.allItems.filter(e=>{const t=g(e,this.itemText),s=t!=null?String(t):"";return this.filter(e,String(this.internalSearch),s)})},internalSearch:{get(){return this.lazySearch},set(e){this.lazySearch!==e&&(this.lazySearch=e,this.$emit("update:search-input",e))}},isAnyValueAllowed(){return!1},isDirty(){return this.searchIsDirty||this.selectedItems.length>0},isSearching(){return this.multiple&&this.searchIsDirty||this.searchIsDirty&&this.internalSearch!==this.getText(this.selectedItem)},menuCanShow(){return this.isFocused?this.hasDisplayedItems||!this.hideNoData:!1},$_menuProps(){const e=i.options.computed.$_menuProps.call(this);return e.contentClass=`v-autocomplete__content ${e.contentClass||""}`.trim(),{...m,...e}},searchIsDirty(){return this.internalSearch!=null&&this.internalSearch!==""},selectedItem(){return this.multiple?null:this.selectedItems.find(e=>this.valueComparator(this.getValue(e),this.getValue(this.internalValue)))},listData(){const e=i.options.computed.listData.call(this);return e.props={...e.props,items:this.virtualizedItems,noFilter:this.noFilter||!this.isSearching||!this.filteredItems.length,searchInput:this.internalSearch},e}},watch:{filteredItems:"onFilteredItemsChanged",internalValue:"setSearch",isFocused(e){e?(document.addEventListener("copy",this.onCopy),this.$refs.input&&this.$refs.input.select()):(document.removeEventListener("copy",this.onCopy),this.blur(),this.updateSelf())},isMenuActive(e){e||!this.hasSlot||(this.lazySearch=null)},items(e,t){!(t&&t.length)&&this.hideNoData&&this.isFocused&&!this.isMenuActive&&e.length&&this.activateMenu()},searchInput(e){this.lazySearch=e},internalSearch:"onInternalSearchChanged",itemText:"updateSelf"},created(){this.setSearch()},destroyed(){document.removeEventListener("copy",this.onCopy)},methods:{onFilteredItemsChanged(e,t){if(e!==t){if(!this.autoSelectFirst){const s=t[this.$refs.menu.listIndex];s?this.setMenuIndex(e.findIndex(n=>n===s)):this.setMenuIndex(-1),this.$emit("update:list-index",this.$refs.menu.listIndex)}this.$nextTick(()=>{!this.internalSearch||e.length!==1&&!this.autoSelectFirst||(this.$refs.menu.getTiles(),this.autoSelectFirst&&e.length&&(this.setMenuIndex(0),this.$emit("update:list-index",this.$refs.menu.listIndex)))})}},onInternalSearchChanged(){this.updateMenuDimensions()},updateMenuDimensions(){this.isMenuActive&&this.$refs.menu&&this.$refs.menu.updateDimensions()},changeSelectedIndex(e){this.searchIsDirty||(this.multiple&&e===l.left?this.selectedIndex===-1?this.selectedIndex=this.selectedItems.length-1:this.selectedIndex--:this.multiple&&e===l.right?this.selectedIndex>=this.selectedItems.length-1?this.selectedIndex=-1:this.selectedIndex++:(e===l.backspace||e===l.delete)&&this.deleteCurrentItem())},deleteCurrentItem(){const e=this.selectedIndex,t=this.selectedItems[e];if(!this.isInteractive||this.getDisabled(t))return;const s=this.selectedItems.length-1;if(this.selectedIndex===-1&&s!==0){this.selectedIndex=s;return}const n=this.selectedItems.length,a=e!==n-1?e:e-1;this.selectedItems[a]?this.selectItem(t):this.setValue(this.multiple?[]:null),this.selectedIndex=a},clearableCallback(){this.internalSearch=null,i.options.methods.clearableCallback.call(this)},genInput(){const e=p.options.methods.genInput.call(this);return e.data=I(e.data,{attrs:{"aria-activedescendant":c(this.$refs.menu,"activeTile.id"),autocomplete:c(e.data,"attrs.autocomplete","off")},domProps:{value:this.internalSearch}}),e},genInputSlot(){const e=i.options.methods.genInputSlot.call(this);return e.data.attrs.role="combobox",e},genSelections(){return this.hasSlot||this.multiple?i.options.methods.genSelections.call(this):[]},onClick(e){!this.isInteractive||(this.selectedIndex>-1?this.selectedIndex=-1:this.onFocus(),this.isAppendInner(e.target)||this.activateMenu())},onInput(e){if(this.selectedIndex>-1||!e.target)return;const t=e.target,s=t.value;t.value&&this.activateMenu(),!this.multiple&&s===""&&this.deleteCurrentItem(),this.internalSearch=s,this.badInput=t.validity&&t.validity.badInput},onKeyDown(e){const t=e.keyCode;(e.ctrlKey||![l.home,l.end].includes(t))&&i.options.methods.onKeyDown.call(this,e),this.changeSelectedIndex(t)},onSpaceDown(e){},onTabDown(e){i.options.methods.onTabDown.call(this,e),this.updateSelf()},onUpDown(e){e.preventDefault(),this.activateMenu()},selectItem(e){i.options.methods.selectItem.call(this,e),this.setSearch()},setSelectedItems(){i.options.methods.setSelectedItems.call(this),this.isFocused||this.setSearch()},setSearch(){this.$nextTick(()=>{(!this.multiple||!this.internalSearch||!this.isMenuActive)&&(this.internalSearch=!this.selectedItems.length||this.multiple||this.hasSlot?null:this.getText(this.selectedItem))})},updateSelf(){!this.searchIsDirty&&!this.internalValue||!this.multiple&&!this.valueComparator(this.internalSearch,this.getValue(this.internalValue))&&this.setSearch()},hasItem(e){return this.selectedValues.indexOf(this.getValue(e))>-1},onCopy(e){var t,s;if(this.selectedIndex===-1)return;const n=this.selectedItems[this.selectedIndex],a=this.getText(n);(t=e.clipboardData)===null||t===void 0||t.setData("text/plain",a),(s=e.clipboardData)===null||s===void 0||s.setData("text/vnd.vuetify.autocomplete.item+plain",a),e.preventDefault()}}}),F=r.extend({name:"v-combobox",props:{delimiters:{type:Array,default:()=>[]},returnObject:{type:Boolean,default:!0}},data:()=>({editingIndex:-1}),computed:{computedCounterValue(){return this.multiple?this.selectedItems.length:(this.internalSearch||"").toString().length},hasSlot(){return i.options.computed.hasSlot.call(this)||this.multiple},isAnyValueAllowed(){return!0},menuCanShow(){return this.isFocused?this.hasDisplayedItems||!!this.$slots["no-data"]&&!this.hideNoData:!1},searchIsDirty(){return this.internalSearch!=null}},methods:{onInternalSearchChanged(e){if(e&&this.multiple&&this.delimiters.length){const t=this.delimiters.find(s=>e.endsWith(s));t!=null&&(this.internalSearch=e.slice(0,e.length-t.length),this.updateTags())}this.updateMenuDimensions()},genInput(){const e=r.options.methods.genInput.call(this);return delete e.data.attrs.name,e.data.on.paste=this.onPaste,e},genChipSelection(e,t){const s=i.options.methods.genChipSelection.call(this,e,t);return this.multiple&&(s.componentOptions.listeners={...s.componentOptions.listeners,dblclick:()=>{this.editingIndex=t,this.internalSearch=this.getText(e),this.selectedIndex=-1}}),s},onChipInput(e){i.options.methods.onChipInput.call(this,e),this.editingIndex=-1},onEnterDown(e){e.preventDefault(),!(this.getMenuIndex()>-1)&&this.$nextTick(this.updateSelf)},onKeyDown(e){const t=e.keyCode;(e.ctrlKey||![l.home,l.end].includes(t))&&i.options.methods.onKeyDown.call(this,e),this.multiple&&t===l.left&&this.$refs.input.selectionStart===0?this.updateSelf():t===l.enter&&this.onEnterDown(e),this.changeSelectedIndex(t)},onTabDown(e){if(this.multiple&&this.internalSearch&&this.getMenuIndex()===-1)return e.preventDefault(),e.stopPropagation(),this.updateTags();r.options.methods.onTabDown.call(this,e)},selectItem(e){this.editingIndex>-1?this.updateEditing():(r.options.methods.selectItem.call(this,e),this.internalSearch&&this.multiple&&this.getText(e).toLocaleLowerCase().includes(this.internalSearch.toLocaleLowerCase())&&(this.internalSearch=null))},setSelectedItems(){this.internalValue==null||this.internalValue===""?this.selectedItems=[]:this.selectedItems=this.multiple?this.internalValue:[this.internalValue]},setValue(e){i.options.methods.setValue.call(this,e===void 0?this.internalSearch:e)},updateEditing(){const e=this.internalValue.slice(),t=this.selectedItems.findIndex(s=>this.getText(s)===this.internalSearch);if(t>-1){const s=typeof e[t]=="object"?Object.assign({},e[t]):e[t];e.splice(t,1),e.push(s)}else e[this.editingIndex]=this.internalSearch;this.setValue(e),this.editingIndex=-1,this.internalSearch=null},updateCombobox(){if(!this.searchIsDirty)return;this.internalSearch!==this.getText(this.internalValue)&&this.setValue(),(Boolean(this.$scopedSlots.selection)||this.hasChips)&&(this.internalSearch=null)},updateSelf(){this.multiple?this.updateTags():this.updateCombobox()},updateTags(){const e=this.getMenuIndex();if(e<0&&!this.searchIsDirty||!this.internalSearch)return;if(this.editingIndex>-1)return this.updateEditing();const t=this.selectedItems.findIndex(n=>this.internalSearch===this.getText(n)),s=t>-1&&typeof this.selectedItems[t]=="object"?Object.assign({},this.selectedItems[t]):this.internalSearch;if(t>-1){const n=this.internalValue.slice();n.splice(t,1),this.setValue(n)}if(e>-1)return this.internalSearch=null;this.selectItem(s),this.internalSearch=null},onPaste(e){var t;if(this.$emit("paste",e),!this.multiple||this.searchIsDirty)return;const s=(t=e.clipboardData)===null||t===void 0?void 0:t.getData("text/vnd.vuetify.autocomplete.item+plain");s&&this.findExistingIndex(s)===-1&&(e.preventDefault(),i.options.methods.selectItem.call(this,s))},clearableCallback(){this.editingIndex=-1,r.options.methods.clearableCallback.call(this)}}});const $={props:{value:{type:[String,Array,Number],required:!0},suggestedValues:{type:Array,default:()=>[]},strict:{type:Boolean,default:!1},name:{type:String,required:!0},rules:{type:Array,default:()=>[]},type:{type:String,default:"text"}},data(){return{internalValue:this.value}},watch:{internalValue(e){this.$emit("input",e)}},methods:{truncate(e){return e?e.length>80?`${e.substr(0,80)}...`:e:""}}};var T=function(){var t=this,s=t._self._c;return s("div",[t.suggestedValues.length>0&&t.strict&&t.suggestedValues.includes("True")&&t.suggestedValues.includes("False")?s(D,{attrs:{"false-value":"False","true-value":"True",label:t.name},model:{value:t.internalValue,callback:function(n){t.internalValue=n},expression:"internalValue"}}):t.name==="Bypasses"?s(r,{attrs:{items:t.suggestedValues,label:t.name,outlined:"",multiple:"",chips:""},model:{value:t.internalValue,callback:function(n){t.internalValue=n},expression:"internalValue"}}):t.name==="CredID"?s(r,{attrs:{items:t.suggestedValues,label:t.name,outlined:"",dense:"","item-value":"ID","item-text":"ID"},scopedSlots:t._u([{key:"item",fn:function(n){return[s(y,[s(_,{domProps:{textContent:t._s(t.truncate(`${n.item.username} ${n.item.domain} ${n.item.password}`))}}),s(x,{domProps:{textContent:t._s(t.truncate(`${n.item.ID}, ${n.item.notes}`))}})],1)]}}]),model:{value:t.internalValue,callback:function(n){t.internalValue=n},expression:"internalValue"}}):t.suggestedValues.length>0&&!t.strict?s(F,{attrs:{items:t.suggestedValues,label:t.name,outlined:"",dense:""},model:{value:t.internalValue,callback:function(n){t.internalValue=n},expression:"internalValue"}}):t.suggestedValues.length>0&&t.strict?s(r,{attrs:{items:t.suggestedValues,label:t.name,outlined:"",dense:""},model:{value:t.internalValue,callback:function(n){t.internalValue=n},expression:"internalValue"}}):s(p,{attrs:{rules:t.rules,label:t.name,type:t.type==="string"?"text":"number",outlined:"",dense:"",required:""},model:{value:t.internalValue,callback:function(n){t.internalValue=n},expression:"internalValue"}})],1)},w=[],k=f($,T,w,!1,null,null,null,null);const h=k.exports;const M={components:{DynamicFormInput:h},props:{options:{type:Object,required:!0},readonly:{type:Boolean,default:!1},priority:{type:Array,default:()=>[]}},data(){return{form:{},valid:!0}},computed:{...S({listeners:"listener/listenerNames",bypasses:"bypass/bypassNames",malleableProfiles:"malleable/profileNames",credentials:"credential/credentials"}),optionalFields(){return this.fields.filter(e=>e.required===!1).map(e=>({...e,type:this.fieldType(e)}))},requiredFields(){return this.fields.filter(e=>e.required===!0).map(e=>({...e,type:this.fieldType(e)}))},fields(){const e=Object.keys(this.options).map(t=>({name:t,...this.options[t]}));return this.priority.slice().reverse().forEach(t=>{const s=e.findIndex(n=>n.name===t);if(s>-1){const n=e.splice(s,1)[0];e.unshift(n)}}),e},rules(){return this.fields.reduce((e,t)=>(e[t.name]=[],t.required===!0&&e[t.name].push(s=>!!s||s===0||`${t.name} is required`),e),{})}},watch:{form:{handler(e){const t={...e};t.Bypasses&&(t.Bypasses=t.Bypasses.join(" ")),this.$emit("input",t)},deep:!0},fields:{immediate:!0,handler(e){const t=e.reduce((s,n)=>(n.name==="Bypasses"&&!Array.isArray(n.value)?s[n.name]=n.value.split(" ")||[]:s[n.name]=n.value==null?"":n.value,s),{});v.set(this,"form",t)}}},mounted(){this.listeners||this.$store.dispatch("listener/getListeners"),this.bypasses||this.$store.dispatch("bypass/getBypasses"),this.malleableProfiles||this.$store.dispatch("malleable/getMalleableProfiles"),this.credentials||this.$store.dispatch("credential/getCredentials")},methods:{suggestedValuesForField(e){return e.name==="Listener"?this.listeners:e.name==="Bypasses"?this.bypasses:e.name==="Profile"?this.malleableProfiles:e.name==="CredID"?this.credentials:e.suggested_values},strictForField(e){return e.name==="Listener"||e.name==="Bypasses"||e.name==="Profile"||e.name==="CredID"?!0:e.strict},fieldExists(e){return this.fields.find(t=>t.name===e)},fieldType(e){return e.value_type==="INTEGER"?"number":e.value_type==="FLOAT"?"float":e.value_type==="BOOLEAN"?"boolean":(e.value_type==="STRING","string")}}};var P=function(){var t=this,s=t._self._c;return s(b,{ref:"form",attrs:{readonly:t.readonly},nativeOn:{submit:function(n){return n.preventDefault(),t.submit.apply(null,arguments)}},model:{value:t.valid,callback:function(n){t.valid=n},expression:"valid"}},[t._l(t.requiredFields,function(n){return s(d,{key:n.name},[s(u,{attrs:{cols:"6"}},[s(h,{attrs:{"suggested-values":t.suggestedValuesForField(n),strict:t.strictForField(n),name:n.name,rules:t.rules[n.name],type:n.type},model:{value:t.form[n.name],callback:function(a){t.$set(t.form,n.name,a)},expression:"form[field.name]"}})],1),s(u,{attrs:{cols:"6"}},[s(o,[t._v(" "+t._s(n.description)+" ")])],1)],1)}),t.optionalFields.length>0?s(o,[t._v(" Optional Fields ")]):t._e(),t.optionalFields.length>0?s(V,{staticClass:"mb-8"}):t._e(),t._l(t.optionalFields,function(n){return s(d,{key:n.name},[s(u,{attrs:{cols:"6"}},[s(h,{attrs:{"suggested-values":t.suggestedValuesForField(n),strict:t.strictForField(n),name:n.name,rules:t.rules[n.name],type:n.type},model:{value:t.form[n.name],callback:function(a){t.$set(t.form,n.name,a)},expression:"form[field.name]"}})],1),s(u,{attrs:{cols:"6"}},[s(o,[t._v(" "+t._s(n.description)+" ")])],1)],1)})],2)},A=[],L=f(M,P,A,!1,null,null,null,null);const z=L.exports;export{z as _,r as a};
